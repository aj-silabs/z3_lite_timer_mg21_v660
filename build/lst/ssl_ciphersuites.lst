###############################################################################
#
# IAR ANSI C/C++ Compiler V8.32.2.178/W32 for ARM         14/Jun/2019  13:19:53
# Copyright 1999-2018 IAR Systems AB.
#
#    Cpu mode     =  
#    Endian       =  little
#    Source file  =  
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.6\util\third_party\mbedtls\library\ssl_ciphersuites.c
#    Command line =  
#        -f C:\Users\alji\AppData\Local\Temp\EW474B.tmp
#        (C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.6\util\third_party\mbedtls\library\ssl_ciphersuites.c
#        -D LOCAL_STORAGE_BTL -D CORTEXM3 -D CORTEXM3_EFR32 -D
#        CORTEXM3_EFR32_MICRO -D CORTEXM3_EFM32_MICRO -D
#        EFR32_SERIES2_CONFIG1_MICRO -D EFR32MG21 -D EFR32MG21A010F1024IM32 -D
#        "ATTRIBUTE_STORAGE_CONFIGURATION=\"z3_lite_timer_mg21_v660_endpoint_config.h\""
#        -D "CONFIGURATION_HEADER=\"app/framework/util/config.h\"" -D
#        "GENERATED_TOKEN_HEADER=\"z3_lite_timer_mg21_v660_tokens.h\"" -D
#        "PLATFORM_HEADER=\"platform/base/hal/micro/cortexm3/compiler/iar.h\""
#        -D "ZA_GENERATED_HEADER=\"z3_lite_timer_mg21_v660.h\"" -D
#        "__SOURCEFILE__=\"ssl_ciphersuites.c\"" -D PSSTORE_SIZE=0 -D
#        LONGTOKEN_SIZE=0 -D LOCKBITS_IN_MAINFLASH_SIZE=8192 -D HAL_CONFIG=1 -D
#        EMBER_AF_USE_HWCONF -D LED_BLINK_PERIOD_MS=1000 -D NO_LED=1 -D
#        "EMBER_AF_API_EMBER_TYPES=\"stack/include/ember-types.h\"" -D
#        "EMBER_AF_API_DEBUG_PRINT=\"app/framework/util/print.h\"" -D
#        "EMBER_AF_API_AF_HEADER=\"app/framework/include/af.h\"" -D
#        "EMBER_AF_API_AF_SECURITY_HEADER=\"app/framework/security/af-security.h\""
#        -D EMBER_STACK_ZIGBEE -D
#        "MBEDTLS_CONFIG_FILE=\"mbedtls-config-generated.h\"" -D USE_NVM3 -D
#        NVM3_DEFAULT_NVM_SIZE=NVM3_FLASH_PAGES*FLASH_PAGE_SIZE -D
#        EMLIB_USER_CONFIG -D HAL_BULBPWM_ENABLE=1 -D
#        HAL_BULBPWM_FREQUENCY=1000 -D
#        "APPLICATION_TOKEN_HEADER=\"znet-token.h\"" -D
#        "APPLICATION_MFG_TOKEN_HEADER=\"znet-mfg-token.h\"" -D
#        "MBEDTLS_DEVICE_ACCELERATION_CONFIG_FILE=\"configs/config-device-acceleration.h\""
#        -D
#        "MBEDTLS_DEVICE_ACCELERATION_CONFIG_APP_FILE=\"config-device-acceleration-app.h\""
#        -D NVM3_FLASH_PAGES=4 -D NVM3_DEFAULT_CACHE_SIZE=200 -D
#        NVM3_MAX_OBJECT_SIZE=254 -D NVM3_DEFAULT_REPACK_HEADROOM=0 -D
#        PHY_RAIL=1 -lC
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\build\lst
#        --diag_suppress Pa050 -o
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\build\obj
#        --no_unroll --no_clustering --debug --endian=little
#        --cpu=Cortex-M33.no_dsp --cmse --no_path_in_file_macros
#        --separate_cluster_for_initialized_variables -e --fpu=None
#        --dlib_config "C:\Program Files (x86)\IAR Systems\Embedded Workbench
#        8.2\arm\inc\c\DLib_Config_Normal.h" -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.6\util\third_party\mbedtls\library\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\protocol\zigbee\app\framework\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\protocol\zigbee\app\framework\..\..\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\protocol\zigbee\app\framework\..\..\stack\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\protocol\zigbee\app\framework\..\util\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\protocol\zigbee\app\framework\include\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\plugin\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\micro\cortexm3\efm32\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\micro\cortexm3\efm32\config\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\micro\cortexm3\efm32\efr32\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\CMSIS\Include\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\Device\SiliconLabs\efr32mg21\Include\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emdrv\common\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emdrv\config\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emdrv\dmadrv\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emdrv\gpiointerrupt\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emdrv\rtcdrv\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emdrv\sleep\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emdrv\spidrv\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emdrv\tempdrv\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emdrv\uartdrv\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emdrv\ustimer\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emlib\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\middleware\glib\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\middleware\glib\glib\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\radio\rail_lib\plugin\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\radio\rail_lib\chip\efr32\rf\common\cortex\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\radio\rail_lib\chip\efr32\rf\rfprotocol\ieee802154\cortex\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\halconfig\inc\hal-config\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\hardware\module\config\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\hardware\kit\common\halconfig\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\hardware\kit\common\bsp\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\hal-config\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\bootloader\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\emdrv\nvm3\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\radio\rail_lib\chip\efr32\efr32xg2x\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\radio\rail_lib\common\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\radio\rail_lib\plugin\coexistence\common\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\radio\rail_lib\plugin\coexistence\hal\efr32\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\radio\rail_lib\plugin\coexistence\protocol\ieee802154\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\radio\rail_lib\protocol\ble\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\radio\rail_lib\protocol\ieee802154\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\radio\rail_lib\protocol\zwave\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\util\plugin\plugin-common\mbedtls\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\util\third_party\mbedtls\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\util\third_party\mbedtls\include\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\util\third_party\mbedtls\include\mbedtls\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\util\third_party\mbedtls\sl_crypto\include\
#        -Ohz --use_c++_inline)
#    Locale       =  C
#    List file    =  
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\build\lst\ssl_ciphersuites.lst
#    Object file  =  
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\build\obj\ssl_ciphersuites.o
#
###############################################################################

C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.6\util\third_party\mbedtls\library\ssl_ciphersuites.c
      1          /***************************************************************************//**
      2           * # License
      3           *
      4           * The licensor of this software is Silicon Laboratories Inc. Your use of this
      5           * software is governed by the terms of Silicon Labs Master Software License
      6           * Agreement (MSLA) available at
      7           * www.silabs.com/about-us/legal/master-software-license-agreement. This
      8           * software is Third Party Software licensed by Silicon Labs from a third party
      9           * and is governed by the sections of the MSLA applicable to Third Party
     10           * Software and the additional terms set forth below.
     11           *
     12           ******************************************************************************/
     13          /**
     14           * \file ssl_ciphersuites.c
     15           *
     16           * \brief SSL ciphersuites for mbed TLS
     17           *
     18           *  Copyright (C) 2006-2015, ARM Limited, All Rights Reserved
     19           *  SPDX-License-Identifier: Apache-2.0
     20           *
     21           *  Licensed under the Apache License, Version 2.0 (the "License"); you may
     22           *  not use this file except in compliance with the License.
     23           *  You may obtain a copy of the License at
     24           *
     25           *  http://www.apache.org/licenses/LICENSE-2.0
     26           *
     27           *  Unless required by applicable law or agreed to in writing, software
     28           *  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
     29           *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     30           *  See the License for the specific language governing permissions and
     31           *  limitations under the License.
     32           *
     33           *  This file is part of mbed TLS (https://tls.mbed.org)
     34           */
     35          
     36          #if !defined(MBEDTLS_CONFIG_FILE)
     37          #include "mbedtls/config.h"
     38          #else
     39          #include MBEDTLS_CONFIG_FILE
     40          #endif
     41          
     42          #if defined(MBEDTLS_SSL_TLS_C)
     43          
     44          #if defined(MBEDTLS_PLATFORM_C)
     45          #include "mbedtls/platform.h"
     46          #else
     47          #include <stdlib.h>
     48          #endif
     49          
     50          #include "mbedtls/ssl_ciphersuites.h"
     51          #include "mbedtls/ssl.h"
     52          
     53          #include <string.h>
     54          
     55          /*
     56           * Ordered from most preferred to least preferred in terms of security.
     57           *
     58           * Current rule (except RC4 and 3DES, weak and null which come last):
     59           * 1. By key exchange:
     60           *    Forward-secure non-PSK > forward-secure PSK > ECJPAKE > other non-PSK > other PSK
     61           * 2. By key length and cipher:
     62           *    AES-256 > Camellia-256 > AES-128 > Camellia-128
     63           * 3. By cipher mode when relevant GCM > CCM > CBC > CCM_8
     64           * 4. By hash function used when relevant
     65           * 5. By key exchange/auth again: EC > non-EC
     66           */
     67          static const int ciphersuite_preference[] =
     68          {
     69          #if defined(MBEDTLS_SSL_CIPHERSUITES)
     70              MBEDTLS_SSL_CIPHERSUITES,
     71          #else
     72              /* All AES-256 ephemeral suites */
     73              MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,
     74              MBEDTLS_TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,
     75              MBEDTLS_TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,
     76              MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_256_CCM,
     77              MBEDTLS_TLS_DHE_RSA_WITH_AES_256_CCM,
     78              MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384,
     79              MBEDTLS_TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384,
     80              MBEDTLS_TLS_DHE_RSA_WITH_AES_256_CBC_SHA256,
     81              MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA,
     82              MBEDTLS_TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,
     83              MBEDTLS_TLS_DHE_RSA_WITH_AES_256_CBC_SHA,
     84              MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_256_CCM_8,
     85              MBEDTLS_TLS_DHE_RSA_WITH_AES_256_CCM_8,
     86          
     87              /* All CAMELLIA-256 ephemeral suites */
     88              MBEDTLS_TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_GCM_SHA384,
     89              MBEDTLS_TLS_ECDHE_RSA_WITH_CAMELLIA_256_GCM_SHA384,
     90              MBEDTLS_TLS_DHE_RSA_WITH_CAMELLIA_256_GCM_SHA384,
     91              MBEDTLS_TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384,
     92              MBEDTLS_TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384,
     93              MBEDTLS_TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256,
     94              MBEDTLS_TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA,
     95          
     96              /* All AES-128 ephemeral suites */
     97              MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,
     98              MBEDTLS_TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,
     99              MBEDTLS_TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,
    100              MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_128_CCM,
    101              MBEDTLS_TLS_DHE_RSA_WITH_AES_128_CCM,
    102              MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256,
    103              MBEDTLS_TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256,
    104              MBEDTLS_TLS_DHE_RSA_WITH_AES_128_CBC_SHA256,
    105              MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,
    106              MBEDTLS_TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,
    107              MBEDTLS_TLS_DHE_RSA_WITH_AES_128_CBC_SHA,
    108              MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8,
    109              MBEDTLS_TLS_DHE_RSA_WITH_AES_128_CCM_8,
    110          
    111              /* All CAMELLIA-128 ephemeral suites */
    112              MBEDTLS_TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_GCM_SHA256,
    113              MBEDTLS_TLS_ECDHE_RSA_WITH_CAMELLIA_128_GCM_SHA256,
    114              MBEDTLS_TLS_DHE_RSA_WITH_CAMELLIA_128_GCM_SHA256,
    115              MBEDTLS_TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256,
    116              MBEDTLS_TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256,
    117              MBEDTLS_TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256,
    118              MBEDTLS_TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA,
    119          
    120              /* The PSK ephemeral suites */
    121              MBEDTLS_TLS_DHE_PSK_WITH_AES_256_GCM_SHA384,
    122              MBEDTLS_TLS_DHE_PSK_WITH_AES_256_CCM,
    123              MBEDTLS_TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384,
    124              MBEDTLS_TLS_DHE_PSK_WITH_AES_256_CBC_SHA384,
    125              MBEDTLS_TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA,
    126              MBEDTLS_TLS_DHE_PSK_WITH_AES_256_CBC_SHA,
    127              MBEDTLS_TLS_DHE_PSK_WITH_CAMELLIA_256_GCM_SHA384,
    128              MBEDTLS_TLS_ECDHE_PSK_WITH_CAMELLIA_256_CBC_SHA384,
    129              MBEDTLS_TLS_DHE_PSK_WITH_CAMELLIA_256_CBC_SHA384,
    130              MBEDTLS_TLS_DHE_PSK_WITH_AES_256_CCM_8,
    131          
    132              MBEDTLS_TLS_DHE_PSK_WITH_AES_128_GCM_SHA256,
    133              MBEDTLS_TLS_DHE_PSK_WITH_AES_128_CCM,
    134              MBEDTLS_TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256,
    135              MBEDTLS_TLS_DHE_PSK_WITH_AES_128_CBC_SHA256,
    136              MBEDTLS_TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA,
    137              MBEDTLS_TLS_DHE_PSK_WITH_AES_128_CBC_SHA,
    138              MBEDTLS_TLS_DHE_PSK_WITH_CAMELLIA_128_GCM_SHA256,
    139              MBEDTLS_TLS_DHE_PSK_WITH_CAMELLIA_128_CBC_SHA256,
    140              MBEDTLS_TLS_ECDHE_PSK_WITH_CAMELLIA_128_CBC_SHA256,
    141              MBEDTLS_TLS_DHE_PSK_WITH_AES_128_CCM_8,
    142          
    143              /* The ECJPAKE suite */
    144              MBEDTLS_TLS_ECJPAKE_WITH_AES_128_CCM_8,
    145          
    146              /* All AES-256 suites */
    147              MBEDTLS_TLS_RSA_WITH_AES_256_GCM_SHA384,
    148              MBEDTLS_TLS_RSA_WITH_AES_256_CCM,
    149              MBEDTLS_TLS_RSA_WITH_AES_256_CBC_SHA256,
    150              MBEDTLS_TLS_RSA_WITH_AES_256_CBC_SHA,
    151              MBEDTLS_TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384,
    152              MBEDTLS_TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384,
    153              MBEDTLS_TLS_ECDH_RSA_WITH_AES_256_CBC_SHA,
    154              MBEDTLS_TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384,
    155              MBEDTLS_TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384,
    156              MBEDTLS_TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA,
    157              MBEDTLS_TLS_RSA_WITH_AES_256_CCM_8,
    158          
    159              /* All CAMELLIA-256 suites */
    160              MBEDTLS_TLS_RSA_WITH_CAMELLIA_256_GCM_SHA384,
    161              MBEDTLS_TLS_RSA_WITH_CAMELLIA_256_CBC_SHA256,
    162              MBEDTLS_TLS_RSA_WITH_CAMELLIA_256_CBC_SHA,
    163              MBEDTLS_TLS_ECDH_RSA_WITH_CAMELLIA_256_GCM_SHA384,
    164              MBEDTLS_TLS_ECDH_RSA_WITH_CAMELLIA_256_CBC_SHA384,
    165              MBEDTLS_TLS_ECDH_ECDSA_WITH_CAMELLIA_256_GCM_SHA384,
    166              MBEDTLS_TLS_ECDH_ECDSA_WITH_CAMELLIA_256_CBC_SHA384,
    167          
    168              /* All AES-128 suites */
    169              MBEDTLS_TLS_RSA_WITH_AES_128_GCM_SHA256,
    170              MBEDTLS_TLS_RSA_WITH_AES_128_CCM,
    171              MBEDTLS_TLS_RSA_WITH_AES_128_CBC_SHA256,
    172              MBEDTLS_TLS_RSA_WITH_AES_128_CBC_SHA,
    173              MBEDTLS_TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256,
    174              MBEDTLS_TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256,
    175              MBEDTLS_TLS_ECDH_RSA_WITH_AES_128_CBC_SHA,
    176              MBEDTLS_TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256,
    177              MBEDTLS_TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256,
    178              MBEDTLS_TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA,
    179              MBEDTLS_TLS_RSA_WITH_AES_128_CCM_8,
    180          
    181              /* All CAMELLIA-128 suites */
    182              MBEDTLS_TLS_RSA_WITH_CAMELLIA_128_GCM_SHA256,
    183              MBEDTLS_TLS_RSA_WITH_CAMELLIA_128_CBC_SHA256,
    184              MBEDTLS_TLS_RSA_WITH_CAMELLIA_128_CBC_SHA,
    185              MBEDTLS_TLS_ECDH_RSA_WITH_CAMELLIA_128_GCM_SHA256,
    186              MBEDTLS_TLS_ECDH_RSA_WITH_CAMELLIA_128_CBC_SHA256,
    187              MBEDTLS_TLS_ECDH_ECDSA_WITH_CAMELLIA_128_GCM_SHA256,
    188              MBEDTLS_TLS_ECDH_ECDSA_WITH_CAMELLIA_128_CBC_SHA256,
    189          
    190              /* The RSA PSK suites */
    191              MBEDTLS_TLS_RSA_PSK_WITH_AES_256_GCM_SHA384,
    192              MBEDTLS_TLS_RSA_PSK_WITH_AES_256_CBC_SHA384,
    193              MBEDTLS_TLS_RSA_PSK_WITH_AES_256_CBC_SHA,
    194              MBEDTLS_TLS_RSA_PSK_WITH_CAMELLIA_256_GCM_SHA384,
    195              MBEDTLS_TLS_RSA_PSK_WITH_CAMELLIA_256_CBC_SHA384,
    196          
    197              MBEDTLS_TLS_RSA_PSK_WITH_AES_128_GCM_SHA256,
    198              MBEDTLS_TLS_RSA_PSK_WITH_AES_128_CBC_SHA256,
    199              MBEDTLS_TLS_RSA_PSK_WITH_AES_128_CBC_SHA,
    200              MBEDTLS_TLS_RSA_PSK_WITH_CAMELLIA_128_GCM_SHA256,
    201              MBEDTLS_TLS_RSA_PSK_WITH_CAMELLIA_128_CBC_SHA256,
    202          
    203              /* The PSK suites */
    204              MBEDTLS_TLS_PSK_WITH_AES_256_GCM_SHA384,
    205              MBEDTLS_TLS_PSK_WITH_AES_256_CCM,
    206              MBEDTLS_TLS_PSK_WITH_AES_256_CBC_SHA384,
    207              MBEDTLS_TLS_PSK_WITH_AES_256_CBC_SHA,
    208              MBEDTLS_TLS_PSK_WITH_CAMELLIA_256_GCM_SHA384,
    209              MBEDTLS_TLS_PSK_WITH_CAMELLIA_256_CBC_SHA384,
    210              MBEDTLS_TLS_PSK_WITH_AES_256_CCM_8,
    211          
    212              MBEDTLS_TLS_PSK_WITH_AES_128_GCM_SHA256,
    213              MBEDTLS_TLS_PSK_WITH_AES_128_CCM,
    214              MBEDTLS_TLS_PSK_WITH_AES_128_CBC_SHA256,
    215              MBEDTLS_TLS_PSK_WITH_AES_128_CBC_SHA,
    216              MBEDTLS_TLS_PSK_WITH_CAMELLIA_128_GCM_SHA256,
    217              MBEDTLS_TLS_PSK_WITH_CAMELLIA_128_CBC_SHA256,
    218              MBEDTLS_TLS_PSK_WITH_AES_128_CCM_8,
    219          
    220              /* 3DES suites */
    221              MBEDTLS_TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA,
    222              MBEDTLS_TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA,
    223              MBEDTLS_TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA,
    224              MBEDTLS_TLS_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA,
    225              MBEDTLS_TLS_DHE_PSK_WITH_3DES_EDE_CBC_SHA,
    226              MBEDTLS_TLS_RSA_WITH_3DES_EDE_CBC_SHA,
    227              MBEDTLS_TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA,
    228              MBEDTLS_TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA,
    229              MBEDTLS_TLS_RSA_PSK_WITH_3DES_EDE_CBC_SHA,
    230              MBEDTLS_TLS_PSK_WITH_3DES_EDE_CBC_SHA,
    231          
    232              /* RC4 suites */
    233              MBEDTLS_TLS_ECDHE_ECDSA_WITH_RC4_128_SHA,
    234              MBEDTLS_TLS_ECDHE_RSA_WITH_RC4_128_SHA,
    235              MBEDTLS_TLS_ECDHE_PSK_WITH_RC4_128_SHA,
    236              MBEDTLS_TLS_DHE_PSK_WITH_RC4_128_SHA,
    237              MBEDTLS_TLS_RSA_WITH_RC4_128_SHA,
    238              MBEDTLS_TLS_RSA_WITH_RC4_128_MD5,
    239              MBEDTLS_TLS_ECDH_RSA_WITH_RC4_128_SHA,
    240              MBEDTLS_TLS_ECDH_ECDSA_WITH_RC4_128_SHA,
    241              MBEDTLS_TLS_RSA_PSK_WITH_RC4_128_SHA,
    242              MBEDTLS_TLS_PSK_WITH_RC4_128_SHA,
    243          
    244              /* Weak suites */
    245              MBEDTLS_TLS_DHE_RSA_WITH_DES_CBC_SHA,
    246              MBEDTLS_TLS_RSA_WITH_DES_CBC_SHA,
    247          
    248              /* NULL suites */
    249              MBEDTLS_TLS_ECDHE_ECDSA_WITH_NULL_SHA,
    250              MBEDTLS_TLS_ECDHE_RSA_WITH_NULL_SHA,
    251              MBEDTLS_TLS_ECDHE_PSK_WITH_NULL_SHA384,
    252              MBEDTLS_TLS_ECDHE_PSK_WITH_NULL_SHA256,
    253              MBEDTLS_TLS_ECDHE_PSK_WITH_NULL_SHA,
    254              MBEDTLS_TLS_DHE_PSK_WITH_NULL_SHA384,
    255              MBEDTLS_TLS_DHE_PSK_WITH_NULL_SHA256,
    256              MBEDTLS_TLS_DHE_PSK_WITH_NULL_SHA,
    257          
    258              MBEDTLS_TLS_RSA_WITH_NULL_SHA256,
    259              MBEDTLS_TLS_RSA_WITH_NULL_SHA,
    260              MBEDTLS_TLS_RSA_WITH_NULL_MD5,
    261              MBEDTLS_TLS_ECDH_RSA_WITH_NULL_SHA,
    262              MBEDTLS_TLS_ECDH_ECDSA_WITH_NULL_SHA,
    263              MBEDTLS_TLS_RSA_PSK_WITH_NULL_SHA384,
    264              MBEDTLS_TLS_RSA_PSK_WITH_NULL_SHA256,
    265              MBEDTLS_TLS_RSA_PSK_WITH_NULL_SHA,
    266              MBEDTLS_TLS_PSK_WITH_NULL_SHA384,
    267              MBEDTLS_TLS_PSK_WITH_NULL_SHA256,
    268              MBEDTLS_TLS_PSK_WITH_NULL_SHA,
    269          
    270          #endif /* MBEDTLS_SSL_CIPHERSUITES */
    271              0
    272          };
    273          
    274          static const mbedtls_ssl_ciphersuite_t ciphersuite_definitions[] =
    275          {
    276          #if defined(MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED)
    277          #if defined(MBEDTLS_AES_C)
    278          #if defined(MBEDTLS_SHA1_C)
    279          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    280              { MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA, "TLS-ECDHE-ECDSA-WITH-AES-128-CBC-SHA",
    281                MBEDTLS_CIPHER_AES_128_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA,
    282                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    283                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    284                0 },
    285              { MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA, "TLS-ECDHE-ECDSA-WITH-AES-256-CBC-SHA",
    286                MBEDTLS_CIPHER_AES_256_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA,
    287                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    288                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    289                0 },
    290          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    291          #endif /* MBEDTLS_SHA1_C */
    292          #if defined(MBEDTLS_SHA256_C)
    293          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    294              { MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256, "TLS-ECDHE-ECDSA-WITH-AES-128-CBC-SHA256",
    295                MBEDTLS_CIPHER_AES_128_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA,
    296                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    297                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    298                0 },
    299          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    300          #if defined(MBEDTLS_GCM_C)
    301              { MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256, "TLS-ECDHE-ECDSA-WITH-AES-128-GCM-SHA256",
    302                MBEDTLS_CIPHER_AES_128_GCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA,
    303                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    304                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    305                0 },
    306          #endif /* MBEDTLS_GCM_C */
    307          #endif /* MBEDTLS_SHA256_C */
    308          #if defined(MBEDTLS_SHA512_C)
    309          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    310              { MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384, "TLS-ECDHE-ECDSA-WITH-AES-256-CBC-SHA384",
    311                MBEDTLS_CIPHER_AES_256_CBC, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA,
    312                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    313                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    314                0 },
    315          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    316          #if defined(MBEDTLS_GCM_C)
    317              { MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, "TLS-ECDHE-ECDSA-WITH-AES-256-GCM-SHA384",
    318                MBEDTLS_CIPHER_AES_256_GCM, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA,
    319                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    320                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    321                0 },
    322          #endif /* MBEDTLS_GCM_C */
    323          #endif /* MBEDTLS_SHA512_C */
    324          #if defined(MBEDTLS_CCM_C)
    325              { MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_256_CCM, "TLS-ECDHE-ECDSA-WITH-AES-256-CCM",
    326                MBEDTLS_CIPHER_AES_256_CCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA,
    327                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    328                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    329                0 },
    330              { MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_256_CCM_8, "TLS-ECDHE-ECDSA-WITH-AES-256-CCM-8",
    331                MBEDTLS_CIPHER_AES_256_CCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA,
    332                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    333                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    334                MBEDTLS_CIPHERSUITE_SHORT_TAG },
    335              { MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_128_CCM, "TLS-ECDHE-ECDSA-WITH-AES-128-CCM",
    336                MBEDTLS_CIPHER_AES_128_CCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA,
    337                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    338                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    339                0 },
    340              { MBEDTLS_TLS_ECDHE_ECDSA_WITH_AES_128_CCM_8, "TLS-ECDHE-ECDSA-WITH-AES-128-CCM-8",
    341                MBEDTLS_CIPHER_AES_128_CCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA,
    342                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    343                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    344                MBEDTLS_CIPHERSUITE_SHORT_TAG },
    345          #endif /* MBEDTLS_CCM_C */
    346          #endif /* MBEDTLS_AES_C */
    347          
    348          #if defined(MBEDTLS_CAMELLIA_C)
    349          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    350          #if defined(MBEDTLS_SHA256_C)
    351              { MBEDTLS_TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256, "TLS-ECDHE-ECDSA-WITH-CAMELLIA-128-CBC-SHA256",
    352                MBEDTLS_CIPHER_CAMELLIA_128_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA,
    353                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    354                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    355                0 },
    356          #endif /* MBEDTLS_SHA256_C */
    357          #if defined(MBEDTLS_SHA512_C)
    358              { MBEDTLS_TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384, "TLS-ECDHE-ECDSA-WITH-CAMELLIA-256-CBC-SHA384",
    359                MBEDTLS_CIPHER_CAMELLIA_256_CBC, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA,
    360                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    361                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    362                0 },
    363          #endif /* MBEDTLS_SHA512_C */
    364          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    365          
    366          #if defined(MBEDTLS_GCM_C)
    367          #if defined(MBEDTLS_SHA256_C)
    368              { MBEDTLS_TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_GCM_SHA256, "TLS-ECDHE-ECDSA-WITH-CAMELLIA-128-GCM-SHA256",
    369                MBEDTLS_CIPHER_CAMELLIA_128_GCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA,
    370                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    371                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    372                0 },
    373          #endif /* MBEDTLS_SHA256_C */
    374          #if defined(MBEDTLS_SHA512_C)
    375              { MBEDTLS_TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_GCM_SHA384, "TLS-ECDHE-ECDSA-WITH-CAMELLIA-256-GCM-SHA384",
    376                MBEDTLS_CIPHER_CAMELLIA_256_GCM, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA,
    377                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    378                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    379                0 },
    380          #endif /* MBEDTLS_SHA512_C */
    381          #endif /* MBEDTLS_GCM_C */
    382          #endif /* MBEDTLS_CAMELLIA_C */
    383          
    384          #if defined(MBEDTLS_DES_C)
    385          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    386          #if defined(MBEDTLS_SHA1_C)
    387              { MBEDTLS_TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA, "TLS-ECDHE-ECDSA-WITH-3DES-EDE-CBC-SHA",
    388                MBEDTLS_CIPHER_DES_EDE3_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA,
    389                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    390                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    391                0 },
    392          #endif /* MBEDTLS_SHA1_C */
    393          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    394          #endif /* MBEDTLS_DES_C */
    395          
    396          #if defined(MBEDTLS_ARC4_C)
    397          #if defined(MBEDTLS_SHA1_C)
    398              { MBEDTLS_TLS_ECDHE_ECDSA_WITH_RC4_128_SHA, "TLS-ECDHE-ECDSA-WITH-RC4-128-SHA",
    399                MBEDTLS_CIPHER_ARC4_128, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA,
    400                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    401                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    402                MBEDTLS_CIPHERSUITE_NODTLS },
    403          #endif /* MBEDTLS_SHA1_C */
    404          #endif /* MBEDTLS_ARC4_C */
    405          
    406          #if defined(MBEDTLS_CIPHER_NULL_CIPHER)
    407          #if defined(MBEDTLS_SHA1_C)
    408              { MBEDTLS_TLS_ECDHE_ECDSA_WITH_NULL_SHA, "TLS-ECDHE-ECDSA-WITH-NULL-SHA",
    409                MBEDTLS_CIPHER_NULL, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA,
    410                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    411                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    412                MBEDTLS_CIPHERSUITE_WEAK },
    413          #endif /* MBEDTLS_SHA1_C */
    414          #endif /* MBEDTLS_CIPHER_NULL_CIPHER */
    415          #endif /* MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED */
    416          
    417          #if defined(MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED)
    418          #if defined(MBEDTLS_AES_C)
    419          #if defined(MBEDTLS_SHA1_C)
    420          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    421              { MBEDTLS_TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA, "TLS-ECDHE-RSA-WITH-AES-128-CBC-SHA",
    422                MBEDTLS_CIPHER_AES_128_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDHE_RSA,
    423                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    424                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    425                0 },
    426              { MBEDTLS_TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA, "TLS-ECDHE-RSA-WITH-AES-256-CBC-SHA",
    427                MBEDTLS_CIPHER_AES_256_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDHE_RSA,
    428                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    429                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    430                0 },
    431          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    432          #endif /* MBEDTLS_SHA1_C */
    433          #if defined(MBEDTLS_SHA256_C)
    434          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    435              { MBEDTLS_TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256, "TLS-ECDHE-RSA-WITH-AES-128-CBC-SHA256",
    436                MBEDTLS_CIPHER_AES_128_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDHE_RSA,
    437                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    438                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    439                0 },
    440          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    441          #if defined(MBEDTLS_GCM_C)
    442              { MBEDTLS_TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256, "TLS-ECDHE-RSA-WITH-AES-128-GCM-SHA256",
    443                MBEDTLS_CIPHER_AES_128_GCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDHE_RSA,
    444                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    445                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    446                0 },
    447          #endif /* MBEDTLS_GCM_C */
    448          #endif /* MBEDTLS_SHA256_C */
    449          #if defined(MBEDTLS_SHA512_C)
    450          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    451              { MBEDTLS_TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384, "TLS-ECDHE-RSA-WITH-AES-256-CBC-SHA384",
    452                MBEDTLS_CIPHER_AES_256_CBC, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_ECDHE_RSA,
    453                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    454                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    455                0 },
    456          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    457          #if defined(MBEDTLS_GCM_C)
    458              { MBEDTLS_TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384, "TLS-ECDHE-RSA-WITH-AES-256-GCM-SHA384",
    459                MBEDTLS_CIPHER_AES_256_GCM, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_ECDHE_RSA,
    460                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    461                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    462                0 },
    463          #endif /* MBEDTLS_GCM_C */
    464          #endif /* MBEDTLS_SHA512_C */
    465          #endif /* MBEDTLS_AES_C */
    466          
    467          #if defined(MBEDTLS_CAMELLIA_C)
    468          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    469          #if defined(MBEDTLS_SHA256_C)
    470              { MBEDTLS_TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256, "TLS-ECDHE-RSA-WITH-CAMELLIA-128-CBC-SHA256",
    471                MBEDTLS_CIPHER_CAMELLIA_128_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDHE_RSA,
    472                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    473                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    474                0 },
    475          #endif /* MBEDTLS_SHA256_C */
    476          #if defined(MBEDTLS_SHA512_C)
    477              { MBEDTLS_TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384, "TLS-ECDHE-RSA-WITH-CAMELLIA-256-CBC-SHA384",
    478                MBEDTLS_CIPHER_CAMELLIA_256_CBC, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_ECDHE_RSA,
    479                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    480                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    481                0 },
    482          #endif /* MBEDTLS_SHA512_C */
    483          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    484          
    485          #if defined(MBEDTLS_GCM_C)
    486          #if defined(MBEDTLS_SHA256_C)
    487              { MBEDTLS_TLS_ECDHE_RSA_WITH_CAMELLIA_128_GCM_SHA256, "TLS-ECDHE-RSA-WITH-CAMELLIA-128-GCM-SHA256",
    488                MBEDTLS_CIPHER_CAMELLIA_128_GCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDHE_RSA,
    489                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    490                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    491                0 },
    492          #endif /* MBEDTLS_SHA256_C */
    493          #if defined(MBEDTLS_SHA512_C)
    494              { MBEDTLS_TLS_ECDHE_RSA_WITH_CAMELLIA_256_GCM_SHA384, "TLS-ECDHE-RSA-WITH-CAMELLIA-256-GCM-SHA384",
    495                MBEDTLS_CIPHER_CAMELLIA_256_GCM, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_ECDHE_RSA,
    496                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    497                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    498                0 },
    499          #endif /* MBEDTLS_SHA512_C */
    500          #endif /* MBEDTLS_GCM_C */
    501          #endif /* MBEDTLS_CAMELLIA_C */
    502          
    503          #if defined(MBEDTLS_DES_C)
    504          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    505          #if defined(MBEDTLS_SHA1_C)
    506              { MBEDTLS_TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA, "TLS-ECDHE-RSA-WITH-3DES-EDE-CBC-SHA",
    507                MBEDTLS_CIPHER_DES_EDE3_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDHE_RSA,
    508                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    509                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    510                0 },
    511          #endif /* MBEDTLS_SHA1_C */
    512          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    513          #endif /* MBEDTLS_DES_C */
    514          
    515          #if defined(MBEDTLS_ARC4_C)
    516          #if defined(MBEDTLS_SHA1_C)
    517              { MBEDTLS_TLS_ECDHE_RSA_WITH_RC4_128_SHA, "TLS-ECDHE-RSA-WITH-RC4-128-SHA",
    518                MBEDTLS_CIPHER_ARC4_128, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDHE_RSA,
    519                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    520                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    521                MBEDTLS_CIPHERSUITE_NODTLS },
    522          #endif /* MBEDTLS_SHA1_C */
    523          #endif /* MBEDTLS_ARC4_C */
    524          
    525          #if defined(MBEDTLS_CIPHER_NULL_CIPHER)
    526          #if defined(MBEDTLS_SHA1_C)
    527              { MBEDTLS_TLS_ECDHE_RSA_WITH_NULL_SHA, "TLS-ECDHE-RSA-WITH-NULL-SHA",
    528                MBEDTLS_CIPHER_NULL, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDHE_RSA,
    529                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    530                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    531                MBEDTLS_CIPHERSUITE_WEAK },
    532          #endif /* MBEDTLS_SHA1_C */
    533          #endif /* MBEDTLS_CIPHER_NULL_CIPHER */
    534          #endif /* MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED */
    535          
    536          #if defined(MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED)
    537          #if defined(MBEDTLS_AES_C)
    538          #if defined(MBEDTLS_SHA512_C) && defined(MBEDTLS_GCM_C)
    539              { MBEDTLS_TLS_DHE_RSA_WITH_AES_256_GCM_SHA384, "TLS-DHE-RSA-WITH-AES-256-GCM-SHA384",
    540                MBEDTLS_CIPHER_AES_256_GCM, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_DHE_RSA,
    541                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    542                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    543                0 },
    544          #endif /* MBEDTLS_SHA512_C && MBEDTLS_GCM_C */
    545          
    546          #if defined(MBEDTLS_SHA256_C)
    547          #if defined(MBEDTLS_GCM_C)
    548              { MBEDTLS_TLS_DHE_RSA_WITH_AES_128_GCM_SHA256, "TLS-DHE-RSA-WITH-AES-128-GCM-SHA256",
    549                MBEDTLS_CIPHER_AES_128_GCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_DHE_RSA,
    550                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    551                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    552                0 },
    553          #endif /* MBEDTLS_GCM_C */
    554          
    555          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    556              { MBEDTLS_TLS_DHE_RSA_WITH_AES_128_CBC_SHA256, "TLS-DHE-RSA-WITH-AES-128-CBC-SHA256",
    557                MBEDTLS_CIPHER_AES_128_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_DHE_RSA,
    558                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    559                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    560                0 },
    561          
    562              { MBEDTLS_TLS_DHE_RSA_WITH_AES_256_CBC_SHA256, "TLS-DHE-RSA-WITH-AES-256-CBC-SHA256",
    563                MBEDTLS_CIPHER_AES_256_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_DHE_RSA,
    564                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    565                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    566                0 },
    567          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    568          #endif /* MBEDTLS_SHA256_C */
    569          
    570          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    571          #if defined(MBEDTLS_SHA1_C)
    572              { MBEDTLS_TLS_DHE_RSA_WITH_AES_128_CBC_SHA, "TLS-DHE-RSA-WITH-AES-128-CBC-SHA",
    573                MBEDTLS_CIPHER_AES_128_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_DHE_RSA,
    574                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
    575                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    576                0 },
    577          
    578              { MBEDTLS_TLS_DHE_RSA_WITH_AES_256_CBC_SHA, "TLS-DHE-RSA-WITH-AES-256-CBC-SHA",
    579                MBEDTLS_CIPHER_AES_256_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_DHE_RSA,
    580                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
    581                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    582                0 },
    583          #endif /* MBEDTLS_SHA1_C */
    584          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    585          #if defined(MBEDTLS_CCM_C)
    586              { MBEDTLS_TLS_DHE_RSA_WITH_AES_256_CCM, "TLS-DHE-RSA-WITH-AES-256-CCM",
    587                MBEDTLS_CIPHER_AES_256_CCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_DHE_RSA,
    588                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    589                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    590                0 },
    591              { MBEDTLS_TLS_DHE_RSA_WITH_AES_256_CCM_8, "TLS-DHE-RSA-WITH-AES-256-CCM-8",
    592                MBEDTLS_CIPHER_AES_256_CCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_DHE_RSA,
    593                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    594                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    595                MBEDTLS_CIPHERSUITE_SHORT_TAG },
    596              { MBEDTLS_TLS_DHE_RSA_WITH_AES_128_CCM, "TLS-DHE-RSA-WITH-AES-128-CCM",
    597                MBEDTLS_CIPHER_AES_128_CCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_DHE_RSA,
    598                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    599                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    600                0 },
    601              { MBEDTLS_TLS_DHE_RSA_WITH_AES_128_CCM_8, "TLS-DHE-RSA-WITH-AES-128-CCM-8",
    602                MBEDTLS_CIPHER_AES_128_CCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_DHE_RSA,
    603                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    604                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    605                MBEDTLS_CIPHERSUITE_SHORT_TAG },
    606          #endif /* MBEDTLS_CCM_C */
    607          #endif /* MBEDTLS_AES_C */
    608          
    609          #if defined(MBEDTLS_CAMELLIA_C)
    610          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    611          #if defined(MBEDTLS_SHA256_C)
    612              { MBEDTLS_TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256, "TLS-DHE-RSA-WITH-CAMELLIA-128-CBC-SHA256",
    613                MBEDTLS_CIPHER_CAMELLIA_128_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_DHE_RSA,
    614                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    615                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    616                0 },
    617          
    618              { MBEDTLS_TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256, "TLS-DHE-RSA-WITH-CAMELLIA-256-CBC-SHA256",
    619                MBEDTLS_CIPHER_CAMELLIA_256_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_DHE_RSA,
    620                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    621                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    622                0 },
    623          #endif /* MBEDTLS_SHA256_C */
    624          
    625          #if defined(MBEDTLS_SHA1_C)
    626              { MBEDTLS_TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA, "TLS-DHE-RSA-WITH-CAMELLIA-128-CBC-SHA",
    627                MBEDTLS_CIPHER_CAMELLIA_128_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_DHE_RSA,
    628                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
    629                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    630                0 },
    631          
    632              { MBEDTLS_TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA, "TLS-DHE-RSA-WITH-CAMELLIA-256-CBC-SHA",
    633                MBEDTLS_CIPHER_CAMELLIA_256_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_DHE_RSA,
    634                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
    635                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    636                0 },
    637          #endif /* MBEDTLS_SHA1_C */
    638          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    639          #if defined(MBEDTLS_GCM_C)
    640          #if defined(MBEDTLS_SHA256_C)
    641              { MBEDTLS_TLS_DHE_RSA_WITH_CAMELLIA_128_GCM_SHA256, "TLS-DHE-RSA-WITH-CAMELLIA-128-GCM-SHA256",
    642                MBEDTLS_CIPHER_CAMELLIA_128_GCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_DHE_RSA,
    643                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    644                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    645                0 },
    646          #endif /* MBEDTLS_SHA256_C */
    647          
    648          #if defined(MBEDTLS_SHA512_C)
    649              { MBEDTLS_TLS_DHE_RSA_WITH_CAMELLIA_256_GCM_SHA384, "TLS-DHE-RSA-WITH-CAMELLIA-256-GCM-SHA384",
    650                MBEDTLS_CIPHER_CAMELLIA_256_GCM, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_DHE_RSA,
    651                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    652                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    653                0 },
    654          #endif /* MBEDTLS_SHA512_C */
    655          #endif /* MBEDTLS_GCM_C */
    656          #endif /* MBEDTLS_CAMELLIA_C */
    657          
    658          #if defined(MBEDTLS_DES_C)
    659          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    660          #if defined(MBEDTLS_SHA1_C)
    661              { MBEDTLS_TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA, "TLS-DHE-RSA-WITH-3DES-EDE-CBC-SHA",
    662                MBEDTLS_CIPHER_DES_EDE3_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_DHE_RSA,
    663                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
    664                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    665                0 },
    666          #endif /* MBEDTLS_SHA1_C */
    667          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    668          #endif /* MBEDTLS_DES_C */
    669          #endif /* MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED */
    670          
    671          #if defined(MBEDTLS_KEY_EXCHANGE_RSA_ENABLED)
    672          #if defined(MBEDTLS_AES_C)
    673          #if defined(MBEDTLS_SHA512_C) && defined(MBEDTLS_GCM_C)
    674              { MBEDTLS_TLS_RSA_WITH_AES_256_GCM_SHA384, "TLS-RSA-WITH-AES-256-GCM-SHA384",
    675                MBEDTLS_CIPHER_AES_256_GCM, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_RSA,
    676                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    677                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    678                0 },
    679          #endif /* MBEDTLS_SHA512_C && MBEDTLS_GCM_C */
    680          
    681          #if defined(MBEDTLS_SHA256_C)
    682          #if defined(MBEDTLS_GCM_C)
    683              { MBEDTLS_TLS_RSA_WITH_AES_128_GCM_SHA256, "TLS-RSA-WITH-AES-128-GCM-SHA256",
    684                MBEDTLS_CIPHER_AES_128_GCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_RSA,
    685                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    686                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    687                0 },
    688          #endif /* MBEDTLS_GCM_C */
    689          
    690          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    691              { MBEDTLS_TLS_RSA_WITH_AES_128_CBC_SHA256, "TLS-RSA-WITH-AES-128-CBC-SHA256",
    692                MBEDTLS_CIPHER_AES_128_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_RSA,
    693                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    694                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    695                0 },
    696          
    697              { MBEDTLS_TLS_RSA_WITH_AES_256_CBC_SHA256, "TLS-RSA-WITH-AES-256-CBC-SHA256",
    698                MBEDTLS_CIPHER_AES_256_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_RSA,
    699                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    700                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    701                0 },
    702          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    703          #endif /* MBEDTLS_SHA256_C */
    704          
    705          #if defined(MBEDTLS_SHA1_C)
    706          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    707              { MBEDTLS_TLS_RSA_WITH_AES_128_CBC_SHA, "TLS-RSA-WITH-AES-128-CBC-SHA",
    708                MBEDTLS_CIPHER_AES_128_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_RSA,
    709                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
    710                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    711                0 },
    712          
    713              { MBEDTLS_TLS_RSA_WITH_AES_256_CBC_SHA, "TLS-RSA-WITH-AES-256-CBC-SHA",
    714                MBEDTLS_CIPHER_AES_256_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_RSA,
    715                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
    716                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    717                0 },
    718          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    719          #endif /* MBEDTLS_SHA1_C */
    720          #if defined(MBEDTLS_CCM_C)
    721              { MBEDTLS_TLS_RSA_WITH_AES_256_CCM, "TLS-RSA-WITH-AES-256-CCM",
    722                MBEDTLS_CIPHER_AES_256_CCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_RSA,
    723                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    724                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    725                0 },
    726              { MBEDTLS_TLS_RSA_WITH_AES_256_CCM_8, "TLS-RSA-WITH-AES-256-CCM-8",
    727                MBEDTLS_CIPHER_AES_256_CCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_RSA,
    728                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    729                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    730                MBEDTLS_CIPHERSUITE_SHORT_TAG },
    731              { MBEDTLS_TLS_RSA_WITH_AES_128_CCM, "TLS-RSA-WITH-AES-128-CCM",
    732                MBEDTLS_CIPHER_AES_128_CCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_RSA,
    733                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    734                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    735                0 },
    736              { MBEDTLS_TLS_RSA_WITH_AES_128_CCM_8, "TLS-RSA-WITH-AES-128-CCM-8",
    737                MBEDTLS_CIPHER_AES_128_CCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_RSA,
    738                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    739                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    740                MBEDTLS_CIPHERSUITE_SHORT_TAG },
    741          #endif /* MBEDTLS_CCM_C */
    742          #endif /* MBEDTLS_AES_C */
    743          
    744          #if defined(MBEDTLS_CAMELLIA_C)
    745          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    746          #if defined(MBEDTLS_SHA256_C)
    747              { MBEDTLS_TLS_RSA_WITH_CAMELLIA_128_CBC_SHA256, "TLS-RSA-WITH-CAMELLIA-128-CBC-SHA256",
    748                MBEDTLS_CIPHER_CAMELLIA_128_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_RSA,
    749                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    750                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    751                0 },
    752          
    753              { MBEDTLS_TLS_RSA_WITH_CAMELLIA_256_CBC_SHA256, "TLS-RSA-WITH-CAMELLIA-256-CBC-SHA256",
    754                MBEDTLS_CIPHER_CAMELLIA_256_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_RSA,
    755                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    756                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    757                0 },
    758          #endif /* MBEDTLS_SHA256_C */
    759          
    760          #if defined(MBEDTLS_SHA1_C)
    761              { MBEDTLS_TLS_RSA_WITH_CAMELLIA_128_CBC_SHA, "TLS-RSA-WITH-CAMELLIA-128-CBC-SHA",
    762                MBEDTLS_CIPHER_CAMELLIA_128_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_RSA,
    763                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
    764                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    765                0 },
    766          
    767              { MBEDTLS_TLS_RSA_WITH_CAMELLIA_256_CBC_SHA, "TLS-RSA-WITH-CAMELLIA-256-CBC-SHA",
    768                MBEDTLS_CIPHER_CAMELLIA_256_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_RSA,
    769                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
    770                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    771                0 },
    772          #endif /* MBEDTLS_SHA1_C */
    773          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    774          
    775          #if defined(MBEDTLS_GCM_C)
    776          #if defined(MBEDTLS_SHA256_C)
    777              { MBEDTLS_TLS_RSA_WITH_CAMELLIA_128_GCM_SHA256, "TLS-RSA-WITH-CAMELLIA-128-GCM-SHA256",
    778                MBEDTLS_CIPHER_CAMELLIA_128_GCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_RSA,
    779                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    780                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    781                0 },
    782          #endif /* MBEDTLS_SHA256_C */
    783          
    784          #if defined(MBEDTLS_SHA1_C)
    785              { MBEDTLS_TLS_RSA_WITH_CAMELLIA_256_GCM_SHA384, "TLS-RSA-WITH-CAMELLIA-256-GCM-SHA384",
    786                MBEDTLS_CIPHER_CAMELLIA_256_GCM, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_RSA,
    787                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    788                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    789                0 },
    790          #endif /* MBEDTLS_SHA1_C */
    791          #endif /* MBEDTLS_GCM_C */
    792          #endif /* MBEDTLS_CAMELLIA_C */
    793          
    794          #if defined(MBEDTLS_DES_C)
    795          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    796          #if defined(MBEDTLS_SHA1_C)
    797              { MBEDTLS_TLS_RSA_WITH_3DES_EDE_CBC_SHA, "TLS-RSA-WITH-3DES-EDE-CBC-SHA",
    798                MBEDTLS_CIPHER_DES_EDE3_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_RSA,
    799                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
    800                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    801                0 },
    802          #endif /* MBEDTLS_SHA1_C */
    803          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    804          #endif /* MBEDTLS_DES_C */
    805          
    806          #if defined(MBEDTLS_ARC4_C)
    807          #if defined(MBEDTLS_MD5_C)
    808              { MBEDTLS_TLS_RSA_WITH_RC4_128_MD5, "TLS-RSA-WITH-RC4-128-MD5",
    809                MBEDTLS_CIPHER_ARC4_128, MBEDTLS_MD_MD5, MBEDTLS_KEY_EXCHANGE_RSA,
    810                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
    811                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    812                MBEDTLS_CIPHERSUITE_NODTLS },
    813          #endif
    814          
    815          #if defined(MBEDTLS_SHA1_C)
    816              { MBEDTLS_TLS_RSA_WITH_RC4_128_SHA, "TLS-RSA-WITH-RC4-128-SHA",
    817                MBEDTLS_CIPHER_ARC4_128, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_RSA,
    818                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
    819                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    820                MBEDTLS_CIPHERSUITE_NODTLS },
    821          #endif
    822          #endif /* MBEDTLS_ARC4_C */
    823          #endif /* MBEDTLS_KEY_EXCHANGE_RSA_ENABLED */
    824          
    825          #if defined(MBEDTLS_KEY_EXCHANGE_ECDH_RSA_ENABLED)
    826          #if defined(MBEDTLS_AES_C)
    827          #if defined(MBEDTLS_SHA1_C)
    828          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    829              { MBEDTLS_TLS_ECDH_RSA_WITH_AES_128_CBC_SHA, "TLS-ECDH-RSA-WITH-AES-128-CBC-SHA",
    830                MBEDTLS_CIPHER_AES_128_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDH_RSA,
    831                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    832                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    833                0 },
    834              { MBEDTLS_TLS_ECDH_RSA_WITH_AES_256_CBC_SHA, "TLS-ECDH-RSA-WITH-AES-256-CBC-SHA",
    835                MBEDTLS_CIPHER_AES_256_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDH_RSA,
    836                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    837                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    838                0 },
    839          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    840          #endif /* MBEDTLS_SHA1_C */
    841          #if defined(MBEDTLS_SHA256_C)
    842          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    843              { MBEDTLS_TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256, "TLS-ECDH-RSA-WITH-AES-128-CBC-SHA256",
    844                MBEDTLS_CIPHER_AES_128_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDH_RSA,
    845                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    846                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    847                0 },
    848          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    849          #if defined(MBEDTLS_GCM_C)
    850              { MBEDTLS_TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256, "TLS-ECDH-RSA-WITH-AES-128-GCM-SHA256",
    851                MBEDTLS_CIPHER_AES_128_GCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDH_RSA,
    852                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    853                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    854                0 },
    855          #endif /* MBEDTLS_GCM_C */
    856          #endif /* MBEDTLS_SHA256_C */
    857          #if defined(MBEDTLS_SHA512_C)
    858          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    859              { MBEDTLS_TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384, "TLS-ECDH-RSA-WITH-AES-256-CBC-SHA384",
    860                MBEDTLS_CIPHER_AES_256_CBC, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_ECDH_RSA,
    861                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    862                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    863                0 },
    864          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    865          #if defined(MBEDTLS_GCM_C)
    866              { MBEDTLS_TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384, "TLS-ECDH-RSA-WITH-AES-256-GCM-SHA384",
    867                MBEDTLS_CIPHER_AES_256_GCM, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_ECDH_RSA,
    868                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    869                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    870                0 },
    871          #endif /* MBEDTLS_GCM_C */
    872          #endif /* MBEDTLS_SHA512_C */
    873          #endif /* MBEDTLS_AES_C */
    874          
    875          #if defined(MBEDTLS_CAMELLIA_C)
    876          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    877          #if defined(MBEDTLS_SHA256_C)
    878              { MBEDTLS_TLS_ECDH_RSA_WITH_CAMELLIA_128_CBC_SHA256, "TLS-ECDH-RSA-WITH-CAMELLIA-128-CBC-SHA256",
    879                MBEDTLS_CIPHER_CAMELLIA_128_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDH_RSA,
    880                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    881                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    882                0 },
    883          #endif /* MBEDTLS_SHA256_C */
    884          #if defined(MBEDTLS_SHA512_C)
    885              { MBEDTLS_TLS_ECDH_RSA_WITH_CAMELLIA_256_CBC_SHA384, "TLS-ECDH-RSA-WITH-CAMELLIA-256-CBC-SHA384",
    886                MBEDTLS_CIPHER_CAMELLIA_256_CBC, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_ECDH_RSA,
    887                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    888                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    889                0 },
    890          #endif /* MBEDTLS_SHA512_C */
    891          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    892          
    893          #if defined(MBEDTLS_GCM_C)
    894          #if defined(MBEDTLS_SHA256_C)
    895              { MBEDTLS_TLS_ECDH_RSA_WITH_CAMELLIA_128_GCM_SHA256, "TLS-ECDH-RSA-WITH-CAMELLIA-128-GCM-SHA256",
    896                MBEDTLS_CIPHER_CAMELLIA_128_GCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDH_RSA,
    897                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    898                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    899                0 },
    900          #endif /* MBEDTLS_SHA256_C */
    901          #if defined(MBEDTLS_SHA512_C)
    902              { MBEDTLS_TLS_ECDH_RSA_WITH_CAMELLIA_256_GCM_SHA384, "TLS-ECDH-RSA-WITH-CAMELLIA-256-GCM-SHA384",
    903                MBEDTLS_CIPHER_CAMELLIA_256_GCM, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_ECDH_RSA,
    904                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    905                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    906                0 },
    907          #endif /* MBEDTLS_SHA512_C */
    908          #endif /* MBEDTLS_GCM_C */
    909          #endif /* MBEDTLS_CAMELLIA_C */
    910          
    911          #if defined(MBEDTLS_DES_C)
    912          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    913          #if defined(MBEDTLS_SHA1_C)
    914              { MBEDTLS_TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA, "TLS-ECDH-RSA-WITH-3DES-EDE-CBC-SHA",
    915                MBEDTLS_CIPHER_DES_EDE3_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDH_RSA,
    916                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    917                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    918                0 },
    919          #endif /* MBEDTLS_SHA1_C */
    920          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    921          #endif /* MBEDTLS_DES_C */
    922          
    923          #if defined(MBEDTLS_ARC4_C)
    924          #if defined(MBEDTLS_SHA1_C)
    925              { MBEDTLS_TLS_ECDH_RSA_WITH_RC4_128_SHA, "TLS-ECDH-RSA-WITH-RC4-128-SHA",
    926                MBEDTLS_CIPHER_ARC4_128, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDH_RSA,
    927                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    928                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    929                MBEDTLS_CIPHERSUITE_NODTLS },
    930          #endif /* MBEDTLS_SHA1_C */
    931          #endif /* MBEDTLS_ARC4_C */
    932          
    933          #if defined(MBEDTLS_CIPHER_NULL_CIPHER)
    934          #if defined(MBEDTLS_SHA1_C)
    935              { MBEDTLS_TLS_ECDH_RSA_WITH_NULL_SHA, "TLS-ECDH-RSA-WITH-NULL-SHA",
    936                MBEDTLS_CIPHER_NULL, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDH_RSA,
    937                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    938                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    939                MBEDTLS_CIPHERSUITE_WEAK },
    940          #endif /* MBEDTLS_SHA1_C */
    941          #endif /* MBEDTLS_CIPHER_NULL_CIPHER */
    942          #endif /* MBEDTLS_KEY_EXCHANGE_ECDH_RSA_ENABLED */
    943          
    944          #if defined(MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA_ENABLED)
    945          #if defined(MBEDTLS_AES_C)
    946          #if defined(MBEDTLS_SHA1_C)
    947          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    948              { MBEDTLS_TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA, "TLS-ECDH-ECDSA-WITH-AES-128-CBC-SHA",
    949                MBEDTLS_CIPHER_AES_128_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA,
    950                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    951                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    952                0 },
    953              { MBEDTLS_TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA, "TLS-ECDH-ECDSA-WITH-AES-256-CBC-SHA",
    954                MBEDTLS_CIPHER_AES_256_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA,
    955                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
    956                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    957                0 },
    958          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    959          #endif /* MBEDTLS_SHA1_C */
    960          #if defined(MBEDTLS_SHA256_C)
    961          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    962              { MBEDTLS_TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256, "TLS-ECDH-ECDSA-WITH-AES-128-CBC-SHA256",
    963                MBEDTLS_CIPHER_AES_128_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA,
    964                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    965                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    966                0 },
    967          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    968          #if defined(MBEDTLS_GCM_C)
    969              { MBEDTLS_TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256, "TLS-ECDH-ECDSA-WITH-AES-128-GCM-SHA256",
    970                MBEDTLS_CIPHER_AES_128_GCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA,
    971                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    972                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    973                0 },
    974          #endif /* MBEDTLS_GCM_C */
    975          #endif /* MBEDTLS_SHA256_C */
    976          #if defined(MBEDTLS_SHA512_C)
    977          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    978              { MBEDTLS_TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384, "TLS-ECDH-ECDSA-WITH-AES-256-CBC-SHA384",
    979                MBEDTLS_CIPHER_AES_256_CBC, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA,
    980                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    981                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    982                0 },
    983          #endif /* MBEDTLS_CIPHER_MODE_CBC */
    984          #if defined(MBEDTLS_GCM_C)
    985              { MBEDTLS_TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384, "TLS-ECDH-ECDSA-WITH-AES-256-GCM-SHA384",
    986                MBEDTLS_CIPHER_AES_256_GCM, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA,
    987                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    988                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
    989                0 },
    990          #endif /* MBEDTLS_GCM_C */
    991          #endif /* MBEDTLS_SHA512_C */
    992          #endif /* MBEDTLS_AES_C */
    993          
    994          #if defined(MBEDTLS_CAMELLIA_C)
    995          #if defined(MBEDTLS_CIPHER_MODE_CBC)
    996          #if defined(MBEDTLS_SHA256_C)
    997              { MBEDTLS_TLS_ECDH_ECDSA_WITH_CAMELLIA_128_CBC_SHA256, "TLS-ECDH-ECDSA-WITH-CAMELLIA-128-CBC-SHA256",
    998                MBEDTLS_CIPHER_CAMELLIA_128_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA,
    999                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1000                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1001                0 },
   1002          #endif /* MBEDTLS_SHA256_C */
   1003          #if defined(MBEDTLS_SHA512_C)
   1004              { MBEDTLS_TLS_ECDH_ECDSA_WITH_CAMELLIA_256_CBC_SHA384, "TLS-ECDH-ECDSA-WITH-CAMELLIA-256-CBC-SHA384",
   1005                MBEDTLS_CIPHER_CAMELLIA_256_CBC, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA,
   1006                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1007                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1008                0 },
   1009          #endif /* MBEDTLS_SHA512_C */
   1010          #endif /* MBEDTLS_CIPHER_MODE_CBC */
   1011          
   1012          #if defined(MBEDTLS_GCM_C)
   1013          #if defined(MBEDTLS_SHA256_C)
   1014              { MBEDTLS_TLS_ECDH_ECDSA_WITH_CAMELLIA_128_GCM_SHA256, "TLS-ECDH-ECDSA-WITH-CAMELLIA-128-GCM-SHA256",
   1015                MBEDTLS_CIPHER_CAMELLIA_128_GCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA,
   1016                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1017                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1018                0 },
   1019          #endif /* MBEDTLS_SHA256_C */
   1020          #if defined(MBEDTLS_SHA512_C)
   1021              { MBEDTLS_TLS_ECDH_ECDSA_WITH_CAMELLIA_256_GCM_SHA384, "TLS-ECDH-ECDSA-WITH-CAMELLIA-256-GCM-SHA384",
   1022                MBEDTLS_CIPHER_CAMELLIA_256_GCM, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA,
   1023                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1024                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1025                0 },
   1026          #endif /* MBEDTLS_SHA512_C */
   1027          #endif /* MBEDTLS_GCM_C */
   1028          #endif /* MBEDTLS_CAMELLIA_C */
   1029          
   1030          #if defined(MBEDTLS_DES_C)
   1031          #if defined(MBEDTLS_CIPHER_MODE_CBC)
   1032          #if defined(MBEDTLS_SHA1_C)
   1033              { MBEDTLS_TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA, "TLS-ECDH-ECDSA-WITH-3DES-EDE-CBC-SHA",
   1034                MBEDTLS_CIPHER_DES_EDE3_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA,
   1035                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1036                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1037                0 },
   1038          #endif /* MBEDTLS_SHA1_C */
   1039          #endif /* MBEDTLS_CIPHER_MODE_CBC */
   1040          #endif /* MBEDTLS_DES_C */
   1041          
   1042          #if defined(MBEDTLS_ARC4_C)
   1043          #if defined(MBEDTLS_SHA1_C)
   1044              { MBEDTLS_TLS_ECDH_ECDSA_WITH_RC4_128_SHA, "TLS-ECDH-ECDSA-WITH-RC4-128-SHA",
   1045                MBEDTLS_CIPHER_ARC4_128, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA,
   1046                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1047                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1048                MBEDTLS_CIPHERSUITE_NODTLS },
   1049          #endif /* MBEDTLS_SHA1_C */
   1050          #endif /* MBEDTLS_ARC4_C */
   1051          
   1052          #if defined(MBEDTLS_CIPHER_NULL_CIPHER)
   1053          #if defined(MBEDTLS_SHA1_C)
   1054              { MBEDTLS_TLS_ECDH_ECDSA_WITH_NULL_SHA, "TLS-ECDH-ECDSA-WITH-NULL-SHA",
   1055                MBEDTLS_CIPHER_NULL, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA,
   1056                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1057                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1058                MBEDTLS_CIPHERSUITE_WEAK },
   1059          #endif /* MBEDTLS_SHA1_C */
   1060          #endif /* MBEDTLS_CIPHER_NULL_CIPHER */
   1061          #endif /* MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA_ENABLED */
   1062          
   1063          #if defined(MBEDTLS_KEY_EXCHANGE_PSK_ENABLED)
   1064          #if defined(MBEDTLS_AES_C)
   1065          #if defined(MBEDTLS_GCM_C)
   1066          #if defined(MBEDTLS_SHA256_C)
   1067              { MBEDTLS_TLS_PSK_WITH_AES_128_GCM_SHA256, "TLS-PSK-WITH-AES-128-GCM-SHA256",
   1068                MBEDTLS_CIPHER_AES_128_GCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_PSK,
   1069                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1070                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1071                0 },
   1072          #endif /* MBEDTLS_SHA256_C */
   1073          
   1074          #if defined(MBEDTLS_SHA512_C)
   1075              { MBEDTLS_TLS_PSK_WITH_AES_256_GCM_SHA384, "TLS-PSK-WITH-AES-256-GCM-SHA384",
   1076                MBEDTLS_CIPHER_AES_256_GCM, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_PSK,
   1077                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1078                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1079                0 },
   1080          #endif /* MBEDTLS_SHA512_C */
   1081          #endif /* MBEDTLS_GCM_C */
   1082          
   1083          #if defined(MBEDTLS_CIPHER_MODE_CBC)
   1084          #if defined(MBEDTLS_SHA256_C)
   1085              { MBEDTLS_TLS_PSK_WITH_AES_128_CBC_SHA256, "TLS-PSK-WITH-AES-128-CBC-SHA256",
   1086                MBEDTLS_CIPHER_AES_128_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_PSK,
   1087                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1088                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1089                0 },
   1090          #endif /* MBEDTLS_SHA256_C */
   1091          
   1092          #if defined(MBEDTLS_SHA512_C)
   1093              { MBEDTLS_TLS_PSK_WITH_AES_256_CBC_SHA384, "TLS-PSK-WITH-AES-256-CBC-SHA384",
   1094                MBEDTLS_CIPHER_AES_256_CBC, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_PSK,
   1095                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1096                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1097                0 },
   1098          #endif /* MBEDTLS_SHA512_C */
   1099          
   1100          #if defined(MBEDTLS_SHA1_C)
   1101              { MBEDTLS_TLS_PSK_WITH_AES_128_CBC_SHA, "TLS-PSK-WITH-AES-128-CBC-SHA",
   1102                MBEDTLS_CIPHER_AES_128_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_PSK,
   1103                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
   1104                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1105                0 },
   1106          
   1107              { MBEDTLS_TLS_PSK_WITH_AES_256_CBC_SHA, "TLS-PSK-WITH-AES-256-CBC-SHA",
   1108                MBEDTLS_CIPHER_AES_256_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_PSK,
   1109                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
   1110                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1111                0 },
   1112          #endif /* MBEDTLS_SHA1_C */
   1113          #endif /* MBEDTLS_CIPHER_MODE_CBC */
   1114          #if defined(MBEDTLS_CCM_C)
   1115              { MBEDTLS_TLS_PSK_WITH_AES_256_CCM, "TLS-PSK-WITH-AES-256-CCM",
   1116                MBEDTLS_CIPHER_AES_256_CCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_PSK,
   1117                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1118                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1119                0 },
   1120              { MBEDTLS_TLS_PSK_WITH_AES_256_CCM_8, "TLS-PSK-WITH-AES-256-CCM-8",
   1121                MBEDTLS_CIPHER_AES_256_CCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_PSK,
   1122                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1123                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1124                MBEDTLS_CIPHERSUITE_SHORT_TAG },
   1125              { MBEDTLS_TLS_PSK_WITH_AES_128_CCM, "TLS-PSK-WITH-AES-128-CCM",
   1126                MBEDTLS_CIPHER_AES_128_CCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_PSK,
   1127                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1128                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1129                0 },
   1130              { MBEDTLS_TLS_PSK_WITH_AES_128_CCM_8, "TLS-PSK-WITH-AES-128-CCM-8",
   1131                MBEDTLS_CIPHER_AES_128_CCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_PSK,
   1132                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1133                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1134                MBEDTLS_CIPHERSUITE_SHORT_TAG },
   1135          #endif /* MBEDTLS_CCM_C */
   1136          #endif /* MBEDTLS_AES_C */
   1137          
   1138          #if defined(MBEDTLS_CAMELLIA_C)
   1139          #if defined(MBEDTLS_CIPHER_MODE_CBC)
   1140          #if defined(MBEDTLS_SHA256_C)
   1141              { MBEDTLS_TLS_PSK_WITH_CAMELLIA_128_CBC_SHA256, "TLS-PSK-WITH-CAMELLIA-128-CBC-SHA256",
   1142                MBEDTLS_CIPHER_CAMELLIA_128_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_PSK,
   1143                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1144                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1145                0 },
   1146          #endif /* MBEDTLS_SHA256_C */
   1147          
   1148          #if defined(MBEDTLS_SHA512_C)
   1149              { MBEDTLS_TLS_PSK_WITH_CAMELLIA_256_CBC_SHA384, "TLS-PSK-WITH-CAMELLIA-256-CBC-SHA384",
   1150                MBEDTLS_CIPHER_CAMELLIA_256_CBC, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_PSK,
   1151                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1152                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1153                0 },
   1154          #endif /* MBEDTLS_SHA512_C */
   1155          #endif /* MBEDTLS_CIPHER_MODE_CBC */
   1156          
   1157          #if defined(MBEDTLS_GCM_C)
   1158          #if defined(MBEDTLS_SHA256_C)
   1159              { MBEDTLS_TLS_PSK_WITH_CAMELLIA_128_GCM_SHA256, "TLS-PSK-WITH-CAMELLIA-128-GCM-SHA256",
   1160                MBEDTLS_CIPHER_CAMELLIA_128_GCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_PSK,
   1161                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1162                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1163                0 },
   1164          #endif /* MBEDTLS_SHA256_C */
   1165          
   1166          #if defined(MBEDTLS_SHA512_C)
   1167              { MBEDTLS_TLS_PSK_WITH_CAMELLIA_256_GCM_SHA384, "TLS-PSK-WITH-CAMELLIA-256-GCM-SHA384",
   1168                MBEDTLS_CIPHER_CAMELLIA_256_GCM, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_PSK,
   1169                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1170                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1171                0 },
   1172          #endif /* MBEDTLS_SHA512_C */
   1173          #endif /* MBEDTLS_GCM_C */
   1174          #endif /* MBEDTLS_CAMELLIA_C */
   1175          
   1176          #if defined(MBEDTLS_DES_C)
   1177          #if defined(MBEDTLS_CIPHER_MODE_CBC)
   1178          #if defined(MBEDTLS_SHA1_C)
   1179              { MBEDTLS_TLS_PSK_WITH_3DES_EDE_CBC_SHA, "TLS-PSK-WITH-3DES-EDE-CBC-SHA",
   1180                MBEDTLS_CIPHER_DES_EDE3_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_PSK,
   1181                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
   1182                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1183                0 },
   1184          #endif /* MBEDTLS_SHA1_C */
   1185          #endif /* MBEDTLS_CIPHER_MODE_CBC */
   1186          #endif /* MBEDTLS_DES_C */
   1187          
   1188          #if defined(MBEDTLS_ARC4_C)
   1189          #if defined(MBEDTLS_SHA1_C)
   1190              { MBEDTLS_TLS_PSK_WITH_RC4_128_SHA, "TLS-PSK-WITH-RC4-128-SHA",
   1191                MBEDTLS_CIPHER_ARC4_128, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_PSK,
   1192                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
   1193                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1194                MBEDTLS_CIPHERSUITE_NODTLS },
   1195          #endif /* MBEDTLS_SHA1_C */
   1196          #endif /* MBEDTLS_ARC4_C */
   1197          #endif /* MBEDTLS_KEY_EXCHANGE_PSK_ENABLED */
   1198          
   1199          #if defined(MBEDTLS_KEY_EXCHANGE_DHE_PSK_ENABLED)
   1200          #if defined(MBEDTLS_AES_C)
   1201          #if defined(MBEDTLS_GCM_C)
   1202          #if defined(MBEDTLS_SHA256_C)
   1203              { MBEDTLS_TLS_DHE_PSK_WITH_AES_128_GCM_SHA256, "TLS-DHE-PSK-WITH-AES-128-GCM-SHA256",
   1204                MBEDTLS_CIPHER_AES_128_GCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_DHE_PSK,
   1205                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1206                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1207                0 },
   1208          #endif /* MBEDTLS_SHA256_C */
   1209          
   1210          #if defined(MBEDTLS_SHA512_C)
   1211              { MBEDTLS_TLS_DHE_PSK_WITH_AES_256_GCM_SHA384, "TLS-DHE-PSK-WITH-AES-256-GCM-SHA384",
   1212                MBEDTLS_CIPHER_AES_256_GCM, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_DHE_PSK,
   1213                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1214                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1215                0 },
   1216          #endif /* MBEDTLS_SHA512_C */
   1217          #endif /* MBEDTLS_GCM_C */
   1218          
   1219          #if defined(MBEDTLS_CIPHER_MODE_CBC)
   1220          #if defined(MBEDTLS_SHA256_C)
   1221              { MBEDTLS_TLS_DHE_PSK_WITH_AES_128_CBC_SHA256, "TLS-DHE-PSK-WITH-AES-128-CBC-SHA256",
   1222                MBEDTLS_CIPHER_AES_128_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_DHE_PSK,
   1223                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1224                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1225                0 },
   1226          #endif /* MBEDTLS_SHA256_C */
   1227          
   1228          #if defined(MBEDTLS_SHA512_C)
   1229              { MBEDTLS_TLS_DHE_PSK_WITH_AES_256_CBC_SHA384, "TLS-DHE-PSK-WITH-AES-256-CBC-SHA384",
   1230                MBEDTLS_CIPHER_AES_256_CBC, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_DHE_PSK,
   1231                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1232                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1233                0 },
   1234          #endif /* MBEDTLS_SHA512_C */
   1235          
   1236          #if defined(MBEDTLS_SHA1_C)
   1237              { MBEDTLS_TLS_DHE_PSK_WITH_AES_128_CBC_SHA, "TLS-DHE-PSK-WITH-AES-128-CBC-SHA",
   1238                MBEDTLS_CIPHER_AES_128_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_DHE_PSK,
   1239                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
   1240                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1241                0 },
   1242          
   1243              { MBEDTLS_TLS_DHE_PSK_WITH_AES_256_CBC_SHA, "TLS-DHE-PSK-WITH-AES-256-CBC-SHA",
   1244                MBEDTLS_CIPHER_AES_256_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_DHE_PSK,
   1245                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
   1246                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1247                0 },
   1248          #endif /* MBEDTLS_SHA1_C */
   1249          #endif /* MBEDTLS_CIPHER_MODE_CBC */
   1250          #if defined(MBEDTLS_CCM_C)
   1251              { MBEDTLS_TLS_DHE_PSK_WITH_AES_256_CCM, "TLS-DHE-PSK-WITH-AES-256-CCM",
   1252                MBEDTLS_CIPHER_AES_256_CCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_DHE_PSK,
   1253                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1254                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1255                0 },
   1256              { MBEDTLS_TLS_DHE_PSK_WITH_AES_256_CCM_8, "TLS-DHE-PSK-WITH-AES-256-CCM-8",
   1257                MBEDTLS_CIPHER_AES_256_CCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_DHE_PSK,
   1258                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1259                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1260                MBEDTLS_CIPHERSUITE_SHORT_TAG },
   1261              { MBEDTLS_TLS_DHE_PSK_WITH_AES_128_CCM, "TLS-DHE-PSK-WITH-AES-128-CCM",
   1262                MBEDTLS_CIPHER_AES_128_CCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_DHE_PSK,
   1263                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1264                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1265                0 },
   1266              { MBEDTLS_TLS_DHE_PSK_WITH_AES_128_CCM_8, "TLS-DHE-PSK-WITH-AES-128-CCM-8",
   1267                MBEDTLS_CIPHER_AES_128_CCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_DHE_PSK,
   1268                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1269                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1270                MBEDTLS_CIPHERSUITE_SHORT_TAG },
   1271          #endif /* MBEDTLS_CCM_C */
   1272          #endif /* MBEDTLS_AES_C */
   1273          
   1274          #if defined(MBEDTLS_CAMELLIA_C)
   1275          #if defined(MBEDTLS_CIPHER_MODE_CBC)
   1276          #if defined(MBEDTLS_SHA256_C)
   1277              { MBEDTLS_TLS_DHE_PSK_WITH_CAMELLIA_128_CBC_SHA256, "TLS-DHE-PSK-WITH-CAMELLIA-128-CBC-SHA256",
   1278                MBEDTLS_CIPHER_CAMELLIA_128_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_DHE_PSK,
   1279                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1280                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1281                0 },
   1282          #endif /* MBEDTLS_SHA256_C */
   1283          
   1284          #if defined(MBEDTLS_SHA512_C)
   1285              { MBEDTLS_TLS_DHE_PSK_WITH_CAMELLIA_256_CBC_SHA384, "TLS-DHE-PSK-WITH-CAMELLIA-256-CBC-SHA384",
   1286                MBEDTLS_CIPHER_CAMELLIA_256_CBC, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_DHE_PSK,
   1287                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1288                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1289                0 },
   1290          #endif /* MBEDTLS_SHA512_C */
   1291          #endif /* MBEDTLS_CIPHER_MODE_CBC */
   1292          
   1293          #if defined(MBEDTLS_GCM_C)
   1294          #if defined(MBEDTLS_SHA256_C)
   1295              { MBEDTLS_TLS_DHE_PSK_WITH_CAMELLIA_128_GCM_SHA256, "TLS-DHE-PSK-WITH-CAMELLIA-128-GCM-SHA256",
   1296                MBEDTLS_CIPHER_CAMELLIA_128_GCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_DHE_PSK,
   1297                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1298                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1299                0 },
   1300          #endif /* MBEDTLS_SHA256_C */
   1301          
   1302          #if defined(MBEDTLS_SHA512_C)
   1303              { MBEDTLS_TLS_DHE_PSK_WITH_CAMELLIA_256_GCM_SHA384, "TLS-DHE-PSK-WITH-CAMELLIA-256-GCM-SHA384",
   1304                MBEDTLS_CIPHER_CAMELLIA_256_GCM, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_DHE_PSK,
   1305                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1306                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1307                0 },
   1308          #endif /* MBEDTLS_SHA512_C */
   1309          #endif /* MBEDTLS_GCM_C */
   1310          #endif /* MBEDTLS_CAMELLIA_C */
   1311          
   1312          #if defined(MBEDTLS_DES_C)
   1313          #if defined(MBEDTLS_CIPHER_MODE_CBC)
   1314          #if defined(MBEDTLS_SHA1_C)
   1315              { MBEDTLS_TLS_DHE_PSK_WITH_3DES_EDE_CBC_SHA, "TLS-DHE-PSK-WITH-3DES-EDE-CBC-SHA",
   1316                MBEDTLS_CIPHER_DES_EDE3_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_DHE_PSK,
   1317                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
   1318                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1319                0 },
   1320          #endif /* MBEDTLS_SHA1_C */
   1321          #endif /* MBEDTLS_CIPHER_MODE_CBC */
   1322          #endif /* MBEDTLS_DES_C */
   1323          
   1324          #if defined(MBEDTLS_ARC4_C)
   1325          #if defined(MBEDTLS_SHA1_C)
   1326              { MBEDTLS_TLS_DHE_PSK_WITH_RC4_128_SHA, "TLS-DHE-PSK-WITH-RC4-128-SHA",
   1327                MBEDTLS_CIPHER_ARC4_128, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_DHE_PSK,
   1328                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
   1329                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1330                MBEDTLS_CIPHERSUITE_NODTLS },
   1331          #endif /* MBEDTLS_SHA1_C */
   1332          #endif /* MBEDTLS_ARC4_C */
   1333          #endif /* MBEDTLS_KEY_EXCHANGE_DHE_PSK_ENABLED */
   1334          
   1335          #if defined(MBEDTLS_KEY_EXCHANGE_ECDHE_PSK_ENABLED)
   1336          #if defined(MBEDTLS_AES_C)
   1337          
   1338          #if defined(MBEDTLS_CIPHER_MODE_CBC)
   1339          #if defined(MBEDTLS_SHA256_C)
   1340              { MBEDTLS_TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256, "TLS-ECDHE-PSK-WITH-AES-128-CBC-SHA256",
   1341                MBEDTLS_CIPHER_AES_128_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDHE_PSK,
   1342                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1343                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1344                0 },
   1345          #endif /* MBEDTLS_SHA256_C */
   1346          
   1347          #if defined(MBEDTLS_SHA512_C)
   1348              { MBEDTLS_TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384, "TLS-ECDHE-PSK-WITH-AES-256-CBC-SHA384",
   1349                MBEDTLS_CIPHER_AES_256_CBC, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_ECDHE_PSK,
   1350                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1351                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1352                0 },
   1353          #endif /* MBEDTLS_SHA512_C */
   1354          
   1355          #if defined(MBEDTLS_SHA1_C)
   1356              { MBEDTLS_TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA, "TLS-ECDHE-PSK-WITH-AES-128-CBC-SHA",
   1357                MBEDTLS_CIPHER_AES_128_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDHE_PSK,
   1358                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1359                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1360                0 },
   1361          
   1362              { MBEDTLS_TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA, "TLS-ECDHE-PSK-WITH-AES-256-CBC-SHA",
   1363                MBEDTLS_CIPHER_AES_256_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDHE_PSK,
   1364                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1365                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1366                0 },
   1367          #endif /* MBEDTLS_SHA1_C */
   1368          #endif /* MBEDTLS_CIPHER_MODE_CBC */
   1369          #endif /* MBEDTLS_AES_C */
   1370          
   1371          #if defined(MBEDTLS_CAMELLIA_C)
   1372          #if defined(MBEDTLS_CIPHER_MODE_CBC)
   1373          #if defined(MBEDTLS_SHA256_C)
   1374              { MBEDTLS_TLS_ECDHE_PSK_WITH_CAMELLIA_128_CBC_SHA256, "TLS-ECDHE-PSK-WITH-CAMELLIA-128-CBC-SHA256",
   1375                MBEDTLS_CIPHER_CAMELLIA_128_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDHE_PSK,
   1376                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1377                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1378                0 },
   1379          #endif /* MBEDTLS_SHA256_C */
   1380          
   1381          #if defined(MBEDTLS_SHA512_C)
   1382              { MBEDTLS_TLS_ECDHE_PSK_WITH_CAMELLIA_256_CBC_SHA384, "TLS-ECDHE-PSK-WITH-CAMELLIA-256-CBC-SHA384",
   1383                MBEDTLS_CIPHER_CAMELLIA_256_CBC, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_ECDHE_PSK,
   1384                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1385                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1386                0 },
   1387          #endif /* MBEDTLS_SHA512_C */
   1388          #endif /* MBEDTLS_CIPHER_MODE_CBC */
   1389          #endif /* MBEDTLS_CAMELLIA_C */
   1390          
   1391          #if defined(MBEDTLS_DES_C)
   1392          #if defined(MBEDTLS_CIPHER_MODE_CBC)
   1393          #if defined(MBEDTLS_SHA1_C)
   1394              { MBEDTLS_TLS_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA, "TLS-ECDHE-PSK-WITH-3DES-EDE-CBC-SHA",
   1395                MBEDTLS_CIPHER_DES_EDE3_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDHE_PSK,
   1396                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1397                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1398                0 },
   1399          #endif /* MBEDTLS_SHA1_C */
   1400          #endif /* MBEDTLS_CIPHER_MODE_CBC */
   1401          #endif /* MBEDTLS_DES_C */
   1402          
   1403          #if defined(MBEDTLS_ARC4_C)
   1404          #if defined(MBEDTLS_SHA1_C)
   1405              { MBEDTLS_TLS_ECDHE_PSK_WITH_RC4_128_SHA, "TLS-ECDHE-PSK-WITH-RC4-128-SHA",
   1406                MBEDTLS_CIPHER_ARC4_128, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDHE_PSK,
   1407                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1408                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1409                MBEDTLS_CIPHERSUITE_NODTLS },
   1410          #endif /* MBEDTLS_SHA1_C */
   1411          #endif /* MBEDTLS_ARC4_C */
   1412          #endif /* MBEDTLS_KEY_EXCHANGE_ECDHE_PSK_ENABLED */
   1413          
   1414          #if defined(MBEDTLS_KEY_EXCHANGE_RSA_PSK_ENABLED)
   1415          #if defined(MBEDTLS_AES_C)
   1416          #if defined(MBEDTLS_GCM_C)
   1417          #if defined(MBEDTLS_SHA256_C)
   1418              { MBEDTLS_TLS_RSA_PSK_WITH_AES_128_GCM_SHA256, "TLS-RSA-PSK-WITH-AES-128-GCM-SHA256",
   1419                MBEDTLS_CIPHER_AES_128_GCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_RSA_PSK,
   1420                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1421                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1422                0 },
   1423          #endif /* MBEDTLS_SHA256_C */
   1424          
   1425          #if defined(MBEDTLS_SHA512_C)
   1426              { MBEDTLS_TLS_RSA_PSK_WITH_AES_256_GCM_SHA384, "TLS-RSA-PSK-WITH-AES-256-GCM-SHA384",
   1427                MBEDTLS_CIPHER_AES_256_GCM, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_RSA_PSK,
   1428                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1429                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1430                0 },
   1431          #endif /* MBEDTLS_SHA512_C */
   1432          #endif /* MBEDTLS_GCM_C */
   1433          
   1434          #if defined(MBEDTLS_CIPHER_MODE_CBC)
   1435          #if defined(MBEDTLS_SHA256_C)
   1436              { MBEDTLS_TLS_RSA_PSK_WITH_AES_128_CBC_SHA256, "TLS-RSA-PSK-WITH-AES-128-CBC-SHA256",
   1437                MBEDTLS_CIPHER_AES_128_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_RSA_PSK,
   1438                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1439                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1440                0 },
   1441          #endif /* MBEDTLS_SHA256_C */
   1442          
   1443          #if defined(MBEDTLS_SHA512_C)
   1444              { MBEDTLS_TLS_RSA_PSK_WITH_AES_256_CBC_SHA384, "TLS-RSA-PSK-WITH-AES-256-CBC-SHA384",
   1445                MBEDTLS_CIPHER_AES_256_CBC, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_RSA_PSK,
   1446                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1447                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1448                0 },
   1449          #endif /* MBEDTLS_SHA512_C */
   1450          
   1451          #if defined(MBEDTLS_SHA1_C)
   1452              { MBEDTLS_TLS_RSA_PSK_WITH_AES_128_CBC_SHA, "TLS-RSA-PSK-WITH-AES-128-CBC-SHA",
   1453                MBEDTLS_CIPHER_AES_128_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_RSA_PSK,
   1454                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1455                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1456                0 },
   1457          
   1458              { MBEDTLS_TLS_RSA_PSK_WITH_AES_256_CBC_SHA, "TLS-RSA-PSK-WITH-AES-256-CBC-SHA",
   1459                MBEDTLS_CIPHER_AES_256_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_RSA_PSK,
   1460                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1461                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1462                0 },
   1463          #endif /* MBEDTLS_SHA1_C */
   1464          #endif /* MBEDTLS_CIPHER_MODE_CBC */
   1465          #endif /* MBEDTLS_AES_C */
   1466          
   1467          #if defined(MBEDTLS_CAMELLIA_C)
   1468          #if defined(MBEDTLS_CIPHER_MODE_CBC)
   1469          #if defined(MBEDTLS_SHA256_C)
   1470              { MBEDTLS_TLS_RSA_PSK_WITH_CAMELLIA_128_CBC_SHA256, "TLS-RSA-PSK-WITH-CAMELLIA-128-CBC-SHA256",
   1471                MBEDTLS_CIPHER_CAMELLIA_128_CBC, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_RSA_PSK,
   1472                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1473                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1474                0 },
   1475          #endif /* MBEDTLS_SHA256_C */
   1476          
   1477          #if defined(MBEDTLS_SHA512_C)
   1478              { MBEDTLS_TLS_RSA_PSK_WITH_CAMELLIA_256_CBC_SHA384, "TLS-RSA-PSK-WITH-CAMELLIA-256-CBC-SHA384",
   1479                MBEDTLS_CIPHER_CAMELLIA_256_CBC, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_RSA_PSK,
   1480                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1481                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1482                0 },
   1483          #endif /* MBEDTLS_SHA512_C */
   1484          #endif /* MBEDTLS_CIPHER_MODE_CBC */
   1485          
   1486          #if defined(MBEDTLS_GCM_C)
   1487          #if defined(MBEDTLS_SHA256_C)
   1488              { MBEDTLS_TLS_RSA_PSK_WITH_CAMELLIA_128_GCM_SHA256, "TLS-RSA-PSK-WITH-CAMELLIA-128-GCM-SHA256",
   1489                MBEDTLS_CIPHER_CAMELLIA_128_GCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_RSA_PSK,
   1490                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1491                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1492                0 },
   1493          #endif /* MBEDTLS_SHA256_C */
   1494          
   1495          #if defined(MBEDTLS_SHA512_C)
   1496              { MBEDTLS_TLS_RSA_PSK_WITH_CAMELLIA_256_GCM_SHA384, "TLS-RSA-PSK-WITH-CAMELLIA-256-GCM-SHA384",
   1497                MBEDTLS_CIPHER_CAMELLIA_256_GCM, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_RSA_PSK,
   1498                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1499                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1500                0 },
   1501          #endif /* MBEDTLS_SHA512_C */
   1502          #endif /* MBEDTLS_GCM_C */
   1503          #endif /* MBEDTLS_CAMELLIA_C */
   1504          
   1505          #if defined(MBEDTLS_DES_C)
   1506          #if defined(MBEDTLS_CIPHER_MODE_CBC)
   1507          #if defined(MBEDTLS_SHA1_C)
   1508              { MBEDTLS_TLS_RSA_PSK_WITH_3DES_EDE_CBC_SHA, "TLS-RSA-PSK-WITH-3DES-EDE-CBC-SHA",
   1509                MBEDTLS_CIPHER_DES_EDE3_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_RSA_PSK,
   1510                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1511                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1512                0 },
   1513          #endif /* MBEDTLS_SHA1_C */
   1514          #endif /* MBEDTLS_CIPHER_MODE_CBC */
   1515          #endif /* MBEDTLS_DES_C */
   1516          
   1517          #if defined(MBEDTLS_ARC4_C)
   1518          #if defined(MBEDTLS_SHA1_C)
   1519              { MBEDTLS_TLS_RSA_PSK_WITH_RC4_128_SHA, "TLS-RSA-PSK-WITH-RC4-128-SHA",
   1520                MBEDTLS_CIPHER_ARC4_128, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_RSA_PSK,
   1521                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1522                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1523                MBEDTLS_CIPHERSUITE_NODTLS },
   1524          #endif /* MBEDTLS_SHA1_C */
   1525          #endif /* MBEDTLS_ARC4_C */
   1526          #endif /* MBEDTLS_KEY_EXCHANGE_RSA_PSK_ENABLED */
   1527          
   1528          #if defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
   1529          #if defined(MBEDTLS_AES_C)
   1530          #if defined(MBEDTLS_CCM_C)
   1531              { MBEDTLS_TLS_ECJPAKE_WITH_AES_128_CCM_8, "TLS-ECJPAKE-WITH-AES-128-CCM-8",
   1532                MBEDTLS_CIPHER_AES_128_CCM, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECJPAKE,
   1533                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1534                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1535                MBEDTLS_CIPHERSUITE_SHORT_TAG },
   1536          #endif /* MBEDTLS_CCM_C */
   1537          #endif /* MBEDTLS_AES_C */
   1538          #endif /* MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED */
   1539          
   1540          #if defined(MBEDTLS_ENABLE_WEAK_CIPHERSUITES)
   1541          #if defined(MBEDTLS_CIPHER_NULL_CIPHER)
   1542          #if defined(MBEDTLS_KEY_EXCHANGE_RSA_ENABLED)
   1543          #if defined(MBEDTLS_MD5_C)
   1544              { MBEDTLS_TLS_RSA_WITH_NULL_MD5, "TLS-RSA-WITH-NULL-MD5",
   1545                MBEDTLS_CIPHER_NULL, MBEDTLS_MD_MD5, MBEDTLS_KEY_EXCHANGE_RSA,
   1546                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
   1547                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1548                MBEDTLS_CIPHERSUITE_WEAK },
   1549          #endif
   1550          
   1551          #if defined(MBEDTLS_SHA1_C)
   1552              { MBEDTLS_TLS_RSA_WITH_NULL_SHA, "TLS-RSA-WITH-NULL-SHA",
   1553                MBEDTLS_CIPHER_NULL, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_RSA,
   1554                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
   1555                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1556                MBEDTLS_CIPHERSUITE_WEAK },
   1557          #endif
   1558          
   1559          #if defined(MBEDTLS_SHA256_C)
   1560              { MBEDTLS_TLS_RSA_WITH_NULL_SHA256, "TLS-RSA-WITH-NULL-SHA256",
   1561                MBEDTLS_CIPHER_NULL, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_RSA,
   1562                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1563                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1564                MBEDTLS_CIPHERSUITE_WEAK },
   1565          #endif
   1566          #endif /* MBEDTLS_KEY_EXCHANGE_RSA_ENABLED */
   1567          
   1568          #if defined(MBEDTLS_KEY_EXCHANGE_PSK_ENABLED)
   1569          #if defined(MBEDTLS_SHA1_C)
   1570              { MBEDTLS_TLS_PSK_WITH_NULL_SHA, "TLS-PSK-WITH-NULL-SHA",
   1571                MBEDTLS_CIPHER_NULL, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_PSK,
   1572                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
   1573                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1574                MBEDTLS_CIPHERSUITE_WEAK },
   1575          #endif /* MBEDTLS_SHA1_C */
   1576          
   1577          #if defined(MBEDTLS_SHA256_C)
   1578              { MBEDTLS_TLS_PSK_WITH_NULL_SHA256, "TLS-PSK-WITH-NULL-SHA256",
   1579                MBEDTLS_CIPHER_NULL, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_PSK,
   1580                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1581                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1582                MBEDTLS_CIPHERSUITE_WEAK },
   1583          #endif
   1584          
   1585          #if defined(MBEDTLS_SHA512_C)
   1586              { MBEDTLS_TLS_PSK_WITH_NULL_SHA384, "TLS-PSK-WITH-NULL-SHA384",
   1587                MBEDTLS_CIPHER_NULL, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_PSK,
   1588                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1589                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1590                MBEDTLS_CIPHERSUITE_WEAK },
   1591          #endif
   1592          #endif /* MBEDTLS_KEY_EXCHANGE_PSK_ENABLED */
   1593          
   1594          #if defined(MBEDTLS_KEY_EXCHANGE_DHE_PSK_ENABLED)
   1595          #if defined(MBEDTLS_SHA1_C)
   1596              { MBEDTLS_TLS_DHE_PSK_WITH_NULL_SHA, "TLS-DHE-PSK-WITH-NULL-SHA",
   1597                MBEDTLS_CIPHER_NULL, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_DHE_PSK,
   1598                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
   1599                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1600                MBEDTLS_CIPHERSUITE_WEAK },
   1601          #endif /* MBEDTLS_SHA1_C */
   1602          
   1603          #if defined(MBEDTLS_SHA256_C)
   1604              { MBEDTLS_TLS_DHE_PSK_WITH_NULL_SHA256, "TLS-DHE-PSK-WITH-NULL-SHA256",
   1605                MBEDTLS_CIPHER_NULL, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_DHE_PSK,
   1606                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1607                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1608                MBEDTLS_CIPHERSUITE_WEAK },
   1609          #endif
   1610          
   1611          #if defined(MBEDTLS_SHA512_C)
   1612              { MBEDTLS_TLS_DHE_PSK_WITH_NULL_SHA384, "TLS-DHE-PSK-WITH-NULL-SHA384",
   1613                MBEDTLS_CIPHER_NULL, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_DHE_PSK,
   1614                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1615                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1616                MBEDTLS_CIPHERSUITE_WEAK },
   1617          #endif
   1618          #endif /* MBEDTLS_KEY_EXCHANGE_DHE_PSK_ENABLED */
   1619          
   1620          #if defined(MBEDTLS_KEY_EXCHANGE_ECDHE_PSK_ENABLED)
   1621          #if defined(MBEDTLS_SHA1_C)
   1622              { MBEDTLS_TLS_ECDHE_PSK_WITH_NULL_SHA, "TLS-ECDHE-PSK-WITH-NULL-SHA",
   1623                MBEDTLS_CIPHER_NULL, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_ECDHE_PSK,
   1624                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1625                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1626                MBEDTLS_CIPHERSUITE_WEAK },
   1627          #endif /* MBEDTLS_SHA1_C */
   1628          
   1629          #if defined(MBEDTLS_SHA256_C)
   1630              { MBEDTLS_TLS_ECDHE_PSK_WITH_NULL_SHA256, "TLS-ECDHE-PSK-WITH-NULL-SHA256",
   1631                MBEDTLS_CIPHER_NULL, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_ECDHE_PSK,
   1632                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1633                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1634                MBEDTLS_CIPHERSUITE_WEAK },
   1635          #endif
   1636          
   1637          #if defined(MBEDTLS_SHA512_C)
   1638              { MBEDTLS_TLS_ECDHE_PSK_WITH_NULL_SHA384, "TLS-ECDHE-PSK-WITH-NULL-SHA384",
   1639                MBEDTLS_CIPHER_NULL, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_ECDHE_PSK,
   1640                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1641                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1642                MBEDTLS_CIPHERSUITE_WEAK },
   1643          #endif
   1644          #endif /* MBEDTLS_KEY_EXCHANGE_ECDHE_PSK_ENABLED */
   1645          
   1646          #if defined(MBEDTLS_KEY_EXCHANGE_RSA_PSK_ENABLED)
   1647          #if defined(MBEDTLS_SHA1_C)
   1648              { MBEDTLS_TLS_RSA_PSK_WITH_NULL_SHA, "TLS-RSA-PSK-WITH-NULL-SHA",
   1649                MBEDTLS_CIPHER_NULL, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_RSA_PSK,
   1650                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1651                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1652                MBEDTLS_CIPHERSUITE_WEAK },
   1653          #endif /* MBEDTLS_SHA1_C */
   1654          
   1655          #if defined(MBEDTLS_SHA256_C)
   1656              { MBEDTLS_TLS_RSA_PSK_WITH_NULL_SHA256, "TLS-RSA-PSK-WITH-NULL-SHA256",
   1657                MBEDTLS_CIPHER_NULL, MBEDTLS_MD_SHA256, MBEDTLS_KEY_EXCHANGE_RSA_PSK,
   1658                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1659                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1660                MBEDTLS_CIPHERSUITE_WEAK },
   1661          #endif
   1662          
   1663          #if defined(MBEDTLS_SHA512_C)
   1664              { MBEDTLS_TLS_RSA_PSK_WITH_NULL_SHA384, "TLS-RSA-PSK-WITH-NULL-SHA384",
   1665                MBEDTLS_CIPHER_NULL, MBEDTLS_MD_SHA384, MBEDTLS_KEY_EXCHANGE_RSA_PSK,
   1666                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_1,
   1667                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1668                MBEDTLS_CIPHERSUITE_WEAK },
   1669          #endif
   1670          #endif /* MBEDTLS_KEY_EXCHANGE_RSA_PSK_ENABLED */
   1671          #endif /* MBEDTLS_CIPHER_NULL_CIPHER */
   1672          
   1673          #if defined(MBEDTLS_DES_C)
   1674          #if defined(MBEDTLS_CIPHER_MODE_CBC)
   1675          #if defined(MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED)
   1676          #if defined(MBEDTLS_SHA1_C)
   1677              { MBEDTLS_TLS_DHE_RSA_WITH_DES_CBC_SHA, "TLS-DHE-RSA-WITH-DES-CBC-SHA",
   1678                MBEDTLS_CIPHER_DES_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_DHE_RSA,
   1679                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
   1680                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1681                MBEDTLS_CIPHERSUITE_WEAK },
   1682          #endif /* MBEDTLS_SHA1_C */
   1683          #endif /* MBEDTLS_KEY_EXCHANGE_DHE_RSA_ENABLED */
   1684          
   1685          #if defined(MBEDTLS_KEY_EXCHANGE_RSA_ENABLED)
   1686          #if defined(MBEDTLS_SHA1_C)
   1687              { MBEDTLS_TLS_RSA_WITH_DES_CBC_SHA, "TLS-RSA-WITH-DES-CBC-SHA",
   1688                MBEDTLS_CIPHER_DES_CBC, MBEDTLS_MD_SHA1, MBEDTLS_KEY_EXCHANGE_RSA,
   1689                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_0,
   1690                MBEDTLS_SSL_MAJOR_VERSION_3, MBEDTLS_SSL_MINOR_VERSION_3,
   1691                MBEDTLS_CIPHERSUITE_WEAK },
   1692          #endif /* MBEDTLS_SHA1_C */
   1693          #endif /* MBEDTLS_KEY_EXCHANGE_RSA_ENABLED */
   1694          #endif /* MBEDTLS_CIPHER_MODE_CBC */
   1695          #endif /* MBEDTLS_DES_C */
   1696          #endif /* MBEDTLS_ENABLE_WEAK_CIPHERSUITES */
   1697          
   1698              { 0, "",
   1699                MBEDTLS_CIPHER_NONE, MBEDTLS_MD_NONE, MBEDTLS_KEY_EXCHANGE_NONE,
   1700                0, 0, 0, 0, 0 }
   1701          };
   1702          
   1703          #if defined(MBEDTLS_SSL_CIPHERSUITES)
   1704          const int *mbedtls_ssl_list_ciphersuites( void )
   1705          {
   1706              return( ciphersuite_preference );
   1707          }
   1708          #else
   1709          #define MAX_CIPHERSUITES    sizeof( ciphersuite_definitions     ) /         \
   1710                                      sizeof( ciphersuite_definitions[0]  )
   1711          static int supported_ciphersuites[MAX_CIPHERSUITES];
   1712          static int supported_init = 0;
   1713          
   1714          static int ciphersuite_is_removed( const mbedtls_ssl_ciphersuite_t *cs_info )
   1715          {
   1716              (void)cs_info;
   1717          
   1718          #if defined(MBEDTLS_REMOVE_ARC4_CIPHERSUITES)
   1719              if( cs_info->cipher == MBEDTLS_CIPHER_ARC4_128 )
   1720                  return( 1 );
   1721          #endif /* MBEDTLS_REMOVE_ARC4_CIPHERSUITES */
   1722          
   1723          #if defined(MBEDTLS_REMOVE_3DES_CIPHERSUITES)
   1724              if( cs_info->cipher == MBEDTLS_CIPHER_DES_EDE3_ECB ||
   1725                  cs_info->cipher == MBEDTLS_CIPHER_DES_EDE3_CBC )
   1726              {
   1727                  return( 1 );
   1728              }
   1729          #endif /* MBEDTLS_REMOVE_3DES_CIPHERSUITES */
   1730          
   1731              return( 0 );
   1732          }
   1733          
   1734          const int *mbedtls_ssl_list_ciphersuites( void )
   1735          {
   1736              /*
   1737               * On initial call filter out all ciphersuites not supported by current
   1738               * build based on presence in the ciphersuite_definitions.
   1739               */
   1740              if( supported_init == 0 )
   1741              {
   1742                  const int *p;
   1743                  int *q;
   1744          
   1745                  for( p = ciphersuite_preference, q = supported_ciphersuites;
   1746                       *p != 0 && q < supported_ciphersuites + MAX_CIPHERSUITES - 1;
   1747                       p++ )
   1748                  {
   1749                      const mbedtls_ssl_ciphersuite_t *cs_info;
   1750                      if( ( cs_info = mbedtls_ssl_ciphersuite_from_id( *p ) ) != NULL &&
   1751                          !ciphersuite_is_removed( cs_info ) )
   1752                      {
   1753                          *(q++) = *p;
   1754                      }
   1755                  }
   1756                  *q = 0;
   1757          
   1758                  supported_init = 1;
   1759              }
   1760          
   1761              return( supported_ciphersuites );
   1762          }
   1763          #endif /* MBEDTLS_SSL_CIPHERSUITES */
   1764          
   1765          const mbedtls_ssl_ciphersuite_t *mbedtls_ssl_ciphersuite_from_string(
   1766                                                          const char *ciphersuite_name )
   1767          {
   1768              const mbedtls_ssl_ciphersuite_t *cur = ciphersuite_definitions;
   1769          
   1770              if( NULL == ciphersuite_name )
   1771                  return( NULL );
   1772          
   1773              while( cur->id != 0 )
   1774              {
   1775                  if( 0 == strcmp( cur->name, ciphersuite_name ) )
   1776                      return( cur );
   1777          
   1778                  cur++;
   1779              }
   1780          
   1781              return( NULL );
   1782          }
   1783          
   1784          const mbedtls_ssl_ciphersuite_t *mbedtls_ssl_ciphersuite_from_id( int ciphersuite )
   1785          {
   1786              const mbedtls_ssl_ciphersuite_t *cur = ciphersuite_definitions;
   1787          
   1788              while( cur->id != 0 )
   1789              {
   1790                  if( cur->id == ciphersuite )
   1791                      return( cur );
   1792          
   1793                  cur++;
   1794              }
   1795          
   1796              return( NULL );
   1797          }
   1798          
   1799          const char *mbedtls_ssl_get_ciphersuite_name( const int ciphersuite_id )
   1800          {
   1801              const mbedtls_ssl_ciphersuite_t *cur;
   1802          
   1803              cur = mbedtls_ssl_ciphersuite_from_id( ciphersuite_id );
   1804          
   1805              if( cur == NULL )
   1806                  return( "unknown" );
   1807          
   1808              return( cur->name );
   1809          }
   1810          
   1811          int mbedtls_ssl_get_ciphersuite_id( const char *ciphersuite_name )
   1812          {
   1813              const mbedtls_ssl_ciphersuite_t *cur;
   1814          
   1815              cur = mbedtls_ssl_ciphersuite_from_string( ciphersuite_name );
   1816          
   1817              if( cur == NULL )
   1818                  return( 0 );
   1819          
   1820              return( cur->id );
   1821          }
   1822          
   1823          #if defined(MBEDTLS_PK_C)
   1824          mbedtls_pk_type_t mbedtls_ssl_get_ciphersuite_sig_pk_alg( const mbedtls_ssl_ciphersuite_t *info )
   1825          {
   1826              switch( info->key_exchange )
   1827              {
   1828                  case MBEDTLS_KEY_EXCHANGE_RSA:
   1829                  case MBEDTLS_KEY_EXCHANGE_DHE_RSA:
   1830                  case MBEDTLS_KEY_EXCHANGE_ECDHE_RSA:
   1831                  case MBEDTLS_KEY_EXCHANGE_RSA_PSK:
   1832                      return( MBEDTLS_PK_RSA );
   1833          
   1834                  case MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA:
   1835                      return( MBEDTLS_PK_ECDSA );
   1836          
   1837                  case MBEDTLS_KEY_EXCHANGE_ECDH_RSA:
   1838                  case MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA:
   1839                      return( MBEDTLS_PK_ECKEY );
   1840          
   1841                  default:
   1842                      return( MBEDTLS_PK_NONE );
   1843              }
   1844          }
   1845          
   1846          mbedtls_pk_type_t mbedtls_ssl_get_ciphersuite_sig_alg( const mbedtls_ssl_ciphersuite_t *info )
   1847          {
   1848              switch( info->key_exchange )
   1849              {
   1850                  case MBEDTLS_KEY_EXCHANGE_RSA:
   1851                  case MBEDTLS_KEY_EXCHANGE_DHE_RSA:
   1852                  case MBEDTLS_KEY_EXCHANGE_ECDHE_RSA:
   1853                      return( MBEDTLS_PK_RSA );
   1854          
   1855                  case MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA:
   1856                      return( MBEDTLS_PK_ECDSA );
   1857          
   1858                  default:
   1859                      return( MBEDTLS_PK_NONE );
   1860              }
   1861          }
   1862          
   1863          #endif /* MBEDTLS_PK_C */
   1864          
   1865          #if defined(MBEDTLS_ECDH_C) || defined(MBEDTLS_ECDSA_C) || \
   1866              defined(MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED)
   1867          int mbedtls_ssl_ciphersuite_uses_ec( const mbedtls_ssl_ciphersuite_t *info )
   1868          {
   1869              switch( info->key_exchange )
   1870              {
   1871                  case MBEDTLS_KEY_EXCHANGE_ECDHE_RSA:
   1872                  case MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA:
   1873                  case MBEDTLS_KEY_EXCHANGE_ECDHE_PSK:
   1874                  case MBEDTLS_KEY_EXCHANGE_ECDH_RSA:
   1875                  case MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA:
   1876                  case MBEDTLS_KEY_EXCHANGE_ECJPAKE:
   1877                      return( 1 );
   1878          
   1879                  default:
   1880                      return( 0 );
   1881              }
   1882          }
   1883          #endif /* MBEDTLS_ECDH_C || MBEDTLS_ECDSA_C || MBEDTLS_KEY_EXCHANGE_ECJPAKE_ENABLED*/
   1884          
   1885          #if defined(MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED)
   1886          int mbedtls_ssl_ciphersuite_uses_psk( const mbedtls_ssl_ciphersuite_t *info )
   1887          {
   1888              switch( info->key_exchange )
   1889              {
   1890                  case MBEDTLS_KEY_EXCHANGE_PSK:
   1891                  case MBEDTLS_KEY_EXCHANGE_RSA_PSK:
   1892                  case MBEDTLS_KEY_EXCHANGE_DHE_PSK:
   1893                  case MBEDTLS_KEY_EXCHANGE_ECDHE_PSK:
   1894                      return( 1 );
   1895          
   1896                  default:
   1897                      return( 0 );
   1898              }
   1899          }
   1900          #endif /* MBEDTLS_KEY_EXCHANGE__SOME__PSK_ENABLED */
   1901          
   1902          #endif /* MBEDTLS_SSL_TLS_C */


 
 
 0 bytes of memory

Errors: none
Warnings: none
