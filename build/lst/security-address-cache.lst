###############################################################################
#
# IAR ANSI C/C++ Compiler V8.32.2.178/W32 for ARM         14/Jun/2019  13:19:47
# Copyright 1999-2018 IAR Systems AB.
#
#    Cpu mode     =  
#    Endian       =  little
#    Source file  =  
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.6\protocol\zigbee\app\util\security\security-address-cache.c
#    Command line =  
#        -f C:\Users\alji\AppData\Local\Temp\EW2D3D.tmp
#        (C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.6\protocol\zigbee\app\util\security\security-address-cache.c
#        -D LOCAL_STORAGE_BTL -D CORTEXM3 -D CORTEXM3_EFR32 -D
#        CORTEXM3_EFR32_MICRO -D CORTEXM3_EFM32_MICRO -D
#        EFR32_SERIES2_CONFIG1_MICRO -D EFR32MG21 -D EFR32MG21A010F1024IM32 -D
#        "ATTRIBUTE_STORAGE_CONFIGURATION=\"z3_lite_timer_mg21_v660_endpoint_config.h\""
#        -D "CONFIGURATION_HEADER=\"app/framework/util/config.h\"" -D
#        "GENERATED_TOKEN_HEADER=\"z3_lite_timer_mg21_v660_tokens.h\"" -D
#        "PLATFORM_HEADER=\"platform/base/hal/micro/cortexm3/compiler/iar.h\""
#        -D "ZA_GENERATED_HEADER=\"z3_lite_timer_mg21_v660.h\"" -D
#        "__SOURCEFILE__=\"security-address-cache.c\"" -D PSSTORE_SIZE=0 -D
#        LONGTOKEN_SIZE=0 -D LOCKBITS_IN_MAINFLASH_SIZE=8192 -D HAL_CONFIG=1 -D
#        EMBER_AF_USE_HWCONF -D LED_BLINK_PERIOD_MS=1000 -D NO_LED=1 -D
#        "EMBER_AF_API_EMBER_TYPES=\"stack/include/ember-types.h\"" -D
#        "EMBER_AF_API_DEBUG_PRINT=\"app/framework/util/print.h\"" -D
#        "EMBER_AF_API_AF_HEADER=\"app/framework/include/af.h\"" -D
#        "EMBER_AF_API_AF_SECURITY_HEADER=\"app/framework/security/af-security.h\""
#        -D EMBER_STACK_ZIGBEE -D
#        "MBEDTLS_CONFIG_FILE=\"mbedtls-config-generated.h\"" -D USE_NVM3 -D
#        NVM3_DEFAULT_NVM_SIZE=NVM3_FLASH_PAGES*FLASH_PAGE_SIZE -D
#        EMLIB_USER_CONFIG -D HAL_BULBPWM_ENABLE=1 -D
#        HAL_BULBPWM_FREQUENCY=1000 -D
#        "APPLICATION_TOKEN_HEADER=\"znet-token.h\"" -D
#        "APPLICATION_MFG_TOKEN_HEADER=\"znet-mfg-token.h\"" -D
#        "MBEDTLS_DEVICE_ACCELERATION_CONFIG_FILE=\"configs/config-device-acceleration.h\""
#        -D
#        "MBEDTLS_DEVICE_ACCELERATION_CONFIG_APP_FILE=\"config-device-acceleration-app.h\""
#        -D NVM3_FLASH_PAGES=4 -D NVM3_DEFAULT_CACHE_SIZE=200 -D
#        NVM3_MAX_OBJECT_SIZE=254 -D NVM3_DEFAULT_REPACK_HEADROOM=0 -D
#        PHY_RAIL=1 -lC
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\build\lst
#        --diag_suppress Pa050 -o
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\build\obj
#        --no_unroll --no_clustering --debug --endian=little
#        --cpu=Cortex-M33.no_dsp --cmse --no_path_in_file_macros
#        --separate_cluster_for_initialized_variables -e --fpu=None
#        --dlib_config "C:\Program Files (x86)\IAR Systems\Embedded Workbench
#        8.2\arm\inc\c\DLib_Config_Normal.h" -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.6\protocol\zigbee\app\util\security\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\protocol\zigbee\app\framework\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\protocol\zigbee\app\framework\..\..\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\protocol\zigbee\app\framework\..\..\stack\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\protocol\zigbee\app\framework\..\util\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\protocol\zigbee\app\framework\include\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\plugin\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\micro\cortexm3\efm32\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\micro\cortexm3\efm32\config\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\micro\cortexm3\efm32\efr32\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\CMSIS\Include\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\Device\SiliconLabs\efr32mg21\Include\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emdrv\common\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emdrv\config\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emdrv\dmadrv\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emdrv\gpiointerrupt\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emdrv\rtcdrv\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emdrv\sleep\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emdrv\spidrv\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emdrv\tempdrv\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emdrv\uartdrv\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emdrv\ustimer\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\emlib\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\middleware\glib\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\middleware\glib\glib\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\radio\rail_lib\plugin\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\radio\rail_lib\chip\efr32\rf\common\cortex\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\base\hal\..\..\radio\rail_lib\chip\efr32\rf\rfprotocol\ieee802154\cortex\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\halconfig\inc\hal-config\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\hardware\module\config\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\hardware\kit\common\halconfig\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\hardware\kit\common\bsp\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\hal-config\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\bootloader\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\emdrv\nvm3\inc\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\radio\rail_lib\chip\efr32\efr32xg2x\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\radio\rail_lib\common\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\radio\rail_lib\plugin\coexistence\common\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\radio\rail_lib\plugin\coexistence\hal\efr32\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\radio\rail_lib\plugin\coexistence\protocol\ieee802154\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\radio\rail_lib\protocol\ble\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\radio\rail_lib\protocol\ieee802154\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\platform\radio\rail_lib\protocol\zwave\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\util\plugin\plugin-common\mbedtls\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\util\third_party\mbedtls\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\util\third_party\mbedtls\include\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\util\third_party\mbedtls\include\mbedtls\
#        -I
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\..\..\v2.6\util\third_party\mbedtls\sl_crypto\include\
#        -Ohz --use_c++_inline)
#    Locale       =  C
#    List file    =  
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\build\lst\security-address-cache.lst
#    Object file  =  
#        C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.5\z3_lite_timer_mg21_v660\build\obj\security-address-cache.o
#
###############################################################################

C:\SiliconLabs\SimplicityStudio\v4\developer\sdks\gecko_sdk_suite\v2.6\protocol\zigbee\app\util\security\security-address-cache.c
      1          /***************************************************************************//**
      2           * @file
      3           * @brief This is the code used by nodes to manage
      4           * the address table cache.  Devices may need this address
      5           *  table cache in order to properly decrypt APS Encrypted messages sent
      6           *  by other devices (i.e. APS_UPDATE_DEVICE).  The source address
      7           *  of the sending device may not be present in the APS Auxiliary Header
      8           *  and therefore the stack will have to look it up.  The stack automatically
      9           *  consults the address table when it is trying to determine the IEEE
     10           *  address from a node ID, so this code utilizes a small portion of the
     11           *  address table to cache the data it needs.
     12           *******************************************************************************
     13           * # License
     14           * <b>Copyright 2018 Silicon Laboratories Inc. www.silabs.com</b>
     15           *******************************************************************************
     16           *
     17           * The licensor of this software is Silicon Laboratories Inc. Your use of this
     18           * software is governed by the terms of Silicon Labs Master Software License
     19           * Agreement (MSLA) available at
     20           * www.silabs.com/about-us/legal/master-software-license-agreement. This
     21           * software is distributed to you in Source Code format and is governed by the
     22           * sections of the MSLA applicable to Source Code.
     23           *
     24           ******************************************************************************/
     25          
     26          //------------------------------------------------------------------------------
     27          // INCLUDES
     28          
     29          #include PLATFORM_HEADER //compiler/micro specifics, types
     30          
     31          #ifdef EZSP_HOST
     32          // Includes needed for ember related functions for the EZSP host
     33            #include "stack/include/error.h"
     34            #include "stack/include/ember-types.h"
     35            #include "app/util/ezsp/ezsp-protocol.h"
     36            #include "app/util/ezsp/ezsp.h"
     37            #include "app/util/ezsp/ezsp-utils.h"
     38            #include "app/util/ezsp/serial-interface.h"
     39          #else
     40          // Includes needed for ember related functions for the EM250
     41            #include "stack/include/ember.h"
     42          #endif // EZSP_HOST
     43          #include "stack/include/error.h"
     44          #include "hal/hal.h"
     45          #include "plugin/serial/serial.h"
     46          #include "app/util/security/security.h"
     47          
     48          //------------------------------------------------------------------------------
     49          

   \                                 In section .bss, align 1
     50          uint8_t addressCacheSize = 0;
   \                     addressCacheSize:
   \        0x0                      DS8 1

   \                                 In section .bss, align 1
     51          static uint8_t addressCacheStartIndex;
   \                     addressCacheStartIndex:
   \        0x0                      DS8 1

   \                                 In section .bss, align 1
     52          static uint8_t nextIndex;                 // relative to addressCacheStartIndex
   \                     nextIndex:
   \        0x0                      DS8 1
     53          
     54          //------------------------------------------------------------------------------
     55          

   \                                 In section .text, align 2, keep-with-next
     56          void securityAddressCacheInit(uint8_t securityAddressCacheStartIndex,
     57                                        uint8_t securityAddressCacheSize)
     58          {
     59            addressCacheStartIndex = securityAddressCacheStartIndex;
   \                     securityAddressCacheInit: (+1)
   \        0x0   0x....             LDR.N    R2,??DataTable1
   \        0x2   0x7010             STRB     R0,[R2, #+0]
     60            addressCacheSize = securityAddressCacheSize;
   \        0x4   0x....             LDR.N    R0,??DataTable1_1
   \        0x6   0x7001             STRB     R1,[R0, #+0]
     61            nextIndex = 0;
   \        0x8   0x2100             MOVS     R1,#+0
   \        0xA   0x....             LDR.N    R3,??DataTable1_2
   \        0xC   0x7019             STRB     R1,[R3, #+0]
     62          }
   \        0xE   0x4770             BX       LR               ;; return
     63          
     64          //------------------------------------------------------------------------------
     65          // The Trust Center Address cache keeps track of EUI64s for the purpose of
     66          // sending APS Encrypted commands.  During joining the Trust Center
     67          // will send an APS Encrypted command to the parent of the device and needs to
     68          // know their long address for creating the Nonce used in encryption.
     69          
     70          // We simply loop through our cache and overwrite the last one received.
     71          

   \                                 In section .text, align 2, keep-with-next
     72          void securityAddToAddressCache(EmberNodeId nodeId, EmberEUI64 nodeEui64)
     73          {
   \                     securityAddToAddressCache: (+1)
   \        0x0   0xE92D 0x47FC      PUSH     {R2-R10,LR}
   \        0x4   0x4682             MOV      R10,R0
     74            uint8_t index = nextIndex;
     75            uint8_t i;
     76          
     77            if (addressCacheSize == 0) {
   \        0x6   0x....             LDR.N    R4,??DataTable1_1
   \        0x8   0x7820             LDRB     R0,[R4, #+0]
   \        0xA   0x....             LDR.N    R7,??DataTable1_2
   \        0xC   0x4688             MOV      R8,R1
   \        0xE   0x783D             LDRB     R5,[R7, #+0]
   \       0x10   0xB3B0             CBZ.N    R0,??securityAddToAddressCache_0
     78              return;
     79            }
     80          
     81            if (nodeId >= EMBER_BROADCAST_ADDRESS) {
   \       0x12   0xF64F 0x72FC      MOVW     R2,#+65532
   \       0x16   0x4592             CMP      R10,R2
   \       0x18   0xDB03             BLT.N    ??securityAddToAddressCache_1
     82              assert(0);
   \       0x1A   0x2152             MOVS     R1,#+82
   \       0x1C   0x....             LDR.N    R0,??DataTable1_3
   \       0x1E   0x....'....        BL       halInternalAssertFailed
     83            }
     84          
     85            // Search through our cache for an existing IEEE with the same info.
     86            // If it exists update that.
     87            for (i = 0; i < addressCacheSize; i++) {
   \                     ??securityAddToAddressCache_1: (+1)
   \       0x22   0x2600             MOVS     R6,#+0
   \       0x24   0x....'....        LDR.W    R9,??DataTable1
   \       0x28   0xE000             B.N      ??securityAddToAddressCache_2
   \                     ??securityAddToAddressCache_3: (+1)
   \       0x2A   0x1C76             ADDS     R6,R6,#+1
   \                     ??securityAddToAddressCache_2: (+1)
   \       0x2C   0x7821             LDRB     R1,[R4, #+0]
   \       0x2E   0xB2F0             UXTB     R0,R6
   \       0x30   0x4288             CMP      R0,R1
   \       0x32   0xD20E             BCS.N    ??securityAddToAddressCache_4
     88              EmberEUI64 eui64;
     89              emberGetAddressTableRemoteEui64(addressCacheStartIndex + i, eui64);
   \       0x34   0xF899 0x0000      LDRB     R0,[R9, #+0]
   \       0x38   0x4669             MOV      R1,SP
   \       0x3A   0x1830             ADDS     R0,R6,R0
   \       0x3C   0xB2C0             UXTB     R0,R0
   \       0x3E   0x....'....        BL       emberGetAddressTableRemoteEui64
     90              if (MEMCOMPARE(eui64, nodeEui64, EUI64_SIZE) == 0) {
   \       0x42   0x2208             MOVS     R2,#+8
   \       0x44   0x4641             MOV      R1,R8
   \       0x46   0x4668             MOV      R0,SP
   \       0x48   0x....'....        BL       halCommonMemCompare
   \       0x4C   0x2800             CMP      R0,#+0
   \       0x4E   0xD1EC             BNE.N    ??securityAddToAddressCache_3
     91                index = i;
   \       0x50   0x4635             MOV      R5,R6
     92                break;
     93              }
     94            }
     95          
     96            if (index == nextIndex) {
   \                     ??securityAddToAddressCache_4: (+1)
   \       0x52   0x7839             LDRB     R1,[R7, #+0]
   \       0x54   0xB2EA             UXTB     R2,R5
   \       0x56   0x428A             CMP      R2,R1
   \       0x58   0xBF01             ITTTT    EQ 
   \       0x5A   0x1C49             ADDEQ    R1,R1,#+1
   \       0x5C   0x7820             LDRBEQ   R0,[R4, #+0]
   \       0x5E   0xB2CB             UXTBEQ   R3,R1
   \       0x60   0x4283             CMPEQ    R3,R0
     97              nextIndex += 1;
     98              if (nextIndex == addressCacheSize) {
   \       0x62   0xBF08             IT       EQ 
   \       0x64   0x2100             MOVEQ    R1,#+0
     99                nextIndex = 0;
   \       0x66   0x7039             STRB     R1,[R7, #+0]
    100              }
    101            }
    102          
    103            index += addressCacheStartIndex;
   \       0x68   0xF899 0x0000      LDRB     R0,[R9, #+0]
    104            if (emberSetAddressTableRemoteEui64(index, nodeEui64)
    105                == EMBER_SUCCESS) {
   \       0x6C   0x4641             MOV      R1,R8
   \       0x6E   0x1945             ADDS     R5,R0,R5
   \       0x70   0xB2E8             UXTB     R0,R5
   \       0x72   0x....'....        BL       emberSetAddressTableRemoteEui64
   \       0x76   0xB918             CBNZ.N   R0,??securityAddToAddressCache_0
    106              emberSetAddressTableRemoteNodeId(index, nodeId);
   \       0x78   0x4651             MOV      R1,R10
   \       0x7A   0xB2E8             UXTB     R0,R5
   \       0x7C   0x....'....        BL       emberSetAddressTableRemoteNodeId
    107            }
    108          }
   \                     ??securityAddToAddressCache_0: (+1)
   \       0x80   0xE8BD 0x87F3      POP      {R0,R1,R4-R10,PC}  ;; return

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable1:
   \        0x0   0x....'....        DC32     addressCacheStartIndex

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable1_1:
   \        0x0   0x....'....        DC32     addressCacheSize

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable1_2:
   \        0x0   0x....'....        DC32     nextIndex

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable1_3:
   \        0x0   0x....'....        DC32     ?_0

   \                                 In section .rodata, align 4
   \                     ?_0:
   \        0x0   0x73 0x65          DC8 "security-address-cache.c"
   \              0x63 0x75    
   \              0x72 0x69    
   \              0x74 0x79    
   \              0x2D 0x61    
   \              0x64 0x64    
   \              0x72 0x65    
   \              0x73 0x73    
   \              0x2D 0x63    
   \              0x61 0x63    
   \              0x68 0x65    
   \              0x2E 0x63    
   \              0x00         
   \       0x19   0x00 0x00          DC8 0, 0, 0
   \              0x00         

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
      40   securityAddToAddressCache
        40   -> emberGetAddressTableRemoteEui64
        40   -> emberSetAddressTableRemoteEui64
        40   -> emberSetAddressTableRemoteNodeId
        40   -> halCommonMemCompare
        40   -> halInternalAssertFailed
       0   securityAddressCacheInit


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable1
       4  ??DataTable1_1
       4  ??DataTable1_2
       4  ??DataTable1_3
      28  ?_0
       1  addressCacheSize
       1  addressCacheStartIndex
       1  nextIndex
     132  securityAddToAddressCache
      16  securityAddressCacheInit

 
   3 bytes in section .bss
  28 bytes in section .rodata
 164 bytes in section .text
 
 164 bytes of CODE  memory
  28 bytes of CONST memory
   3 bytes of DATA  memory

Errors: none
Warnings: none
